!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o=n(1);window.Powerbi=o.PowerBi,window.powerbi=new o.PowerBi},function(e,t,n){var o=n(2),r=n(4),i=n(5),s=n(3),a=function(){function e(t){void 0===t&&(t={}),this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=s.Utils.assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&this.enableAutoEmbed()}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("["+o.Embed.embedUrlAttribute+"]"));n.forEach(function(e){return t.embed(e)})},e.prototype.embed=function(e,t){void 0===t&&(t={});var n,o=e;return n=o.powerBiEmbed?this.embedExisting(o,t):this.embedNew(o,t)},e.prototype.embedNew=function(t,n){var i=this,a=n.type||t.getAttribute(o.Embed.typeAttribute);if(!a)throw new Error("Attempted to embed using config "+JSON.stringify(n)+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as '"+o.Embed.typeAttribute+'="'+r.Report.name.toLowerCase()+"\"'.");n.type=a;var c=s.Utils.find(function(e){return a===e.name.toLowerCase()},e.components);if(!c)throw new Error("Attempted to embed component of type: "+a+" but did not find any matching component.  Please verify the type you specified is intended.");n.getGlobalAccessToken=function(){return i.accessToken};var l=new c(t,n);return t.powerBiEmbed=l,this.embeds.push(l),l},e.prototype.embedExisting=function(e,t){var n=s.Utils.find(function(t){return t.element===e},this.embeds);if(!n)throw new Error("Attempted to embed using config "+JSON.stringify(t)+" on element "+e.outerHTML+" which already has embedded comopnent associated, but could not find the existing comopnent in the list of active components. This could indicate the embeds list is out of sync with the DOM, or the component is referencing the incorrect HTML element.");return n.load(t,!0),n},e.prototype.enableAutoEmbed=function(){var e=this;window.addEventListener("DOMContentLoaded",function(t){return e.init(document.body)},!1)},e.prototype.get=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");return t.powerBiEmbed},e.prototype.reset=function(e){var t=e;if(t.powerBiEmbed){s.Utils.remove(function(e){return e===t.powerBiEmbed},this.embeds),delete t.powerBiEmbed;var n=e.querySelector("iframe");n&&n.remove()}},e.prototype.onReceiveMessage=function(t){if(t)try{var n=s.Utils.find(function(e){return t.source===e.iframe.contentWindow},this.embeds);if(n){var o="string"==typeof t.data?JSON.parse(t.data):t.data;s.Utils.raiseCustomEvent(n.element,e.eventMap[o.event],o)}}catch(r){if("function"!=typeof this.config.onError)throw r;this.config.onError.call(window,r)}},e.components=[i.Tile,r.Report],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();t.PowerBi=a},function(e,t,n){var o=n(3),r=function(){function e(t,n){var r=this;this.element=t,this.options=o.Utils.assign({},e.defaultOptions,n),this.options.accessToken=this.getAccessToken(),this.options.embedUrl=this.getEmbedUrl();var i='<iframe style="width:100%;height:100%;" src="'+this.options.embedUrl+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",function(){return r.load(r.options,!1)},!1)}return e.prototype.load=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=null),!n)throw new Error("You called load without providing message properties from the concrete embeddable class.");var r={accessToken:e.accessToken};o.Utils.assign(n,r);var i={message:n};o.Utils.raiseCustomEvent(this.element,i.message.action,i),this.iframe.contentWindow.postMessage(JSON.stringify(i.message),"*")},e.prototype.getAccessToken=function(){var t=this.options.accessToken||this.element.getAttribute(e.accessTokenAttribute)||this.options.getGlobalAccessToken();if(!t)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute '"+e.accessTokenAttribute+"' or specify a global token at: powerbi.accessToken.");return t},e.prototype.getEmbedUrl=function(){var t=this.options.embedUrl||this.element.getAttribute(e.embedUrlAttribute);if("string"!=typeof t||0===t.length)throw new Error("Embed Url is required, but it was not found. You must provide an embed url either as part of embed configuration or as attribute '"+e.embedUrlAttribute+"'.");return t},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.embedUrlAttribute="powerbi-embed-url",e.accessTokenAttribute="powerbi-access-token",e.typeAttribute="powerbi-type",e.defaultOptions={filterPaneEnabled:!0},e}();t.Embed=r},function(e,t){var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second parameter that was not an array. You passed: "+t);var n;return t.some(function(t,o){return e(t)?(n=o,!0):void 0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();t.Utils=n},function(e,t,n){var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadReport",reportId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Report",t}(r.Embed);t.Report=i},function(e,t,n){var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadTile",tileId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t.name="Tile",t}(r.Embed);t.Tile=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsIlBvd2VyQmkiLCJwb3dlcmJpIiwiZW1iZWRfMSIsInJlcG9ydF8xIiwidGlsZV8xIiwidXRpbF8xIiwiY29uZmlnIiwidGhpcyIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsIlV0aWxzIiwiYXNzaWduIiwiZGVmYXVsdENvbmZpZyIsImF1dG9FbWJlZE9uQ29udGVudExvYWRlZCIsImVuYWJsZUF1dG9FbWJlZCIsInByb3RvdHlwZSIsImluaXQiLCJjb250YWluZXIiLCJfdGhpcyIsIkhUTUxFbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwiZWxlbWVudHMiLCJBcnJheSIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsIkVtYmVkIiwiZW1iZWRVcmxBdHRyaWJ1dGUiLCJmb3JFYWNoIiwiZWxlbWVudCIsImVtYmVkIiwiY29tcG9uZW50IiwicG93ZXJCaUVsZW1lbnQiLCJwb3dlckJpRW1iZWQiLCJlbWJlZEV4aXN0aW5nIiwiZW1iZWROZXciLCJjb21wb25lbnRUeXBlIiwidHlwZSIsImdldEF0dHJpYnV0ZSIsInR5cGVBdHRyaWJ1dGUiLCJFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJvdXRlckhUTUwiLCJSZXBvcnQiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJDb21wb25lbnQiLCJmaW5kIiwiY29tcG9uZW50cyIsImdldEdsb2JhbEFjY2Vzc1Rva2VuIiwiYWNjZXNzVG9rZW4iLCJwdXNoIiwieCIsImxvYWQiLCJldmVudCIsImdldCIsInJlc2V0IiwicmVtb3ZlIiwiaWZyYW1lIiwicXVlcnlTZWxlY3RvciIsInNvdXJjZSIsImNvbnRlbnRXaW5kb3ciLCJtZXNzYWdlRGF0YSIsImRhdGEiLCJwYXJzZSIsInJhaXNlQ3VzdG9tRXZlbnQiLCJldmVudE1hcCIsImUiLCJvbkVycm9yIiwiVGlsZSIsInRpbGVDbGlja2VkIiwidGlsZUxvYWRlZCIsInJlcG9ydFBhZ2VMb2FkZWQiLCJhcmdzIiwiX2kiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwib3B0aW9ucyIsImRlZmF1bHRPcHRpb25zIiwiZ2V0QWNjZXNzVG9rZW4iLCJlbWJlZFVybCIsImdldEVtYmVkVXJsIiwiaWZyYW1lSHRtbCIsImlubmVySFRNTCIsImNoaWxkTm9kZXMiLCJyZXF1aXJlSWQiLCJtZXNzYWdlIiwiYmFzZU1lc3NhZ2UiLCJhY3Rpb24iLCJwb3N0TWVzc2FnZSIsImFjY2Vzc1Rva2VuQXR0cmlidXRlIiwiZnVsbHNjcmVlbiIsInJlcXVlc3RGdWxsU2NyZWVuIiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtc1JlcXVlc3RGdWxsc2NyZWVuIiwibW96UmVxdWVzdEZ1bGxTY3JlZW4iLCJ3ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwiaXNGdWxsc2NyZWVuIiwibW96Q2FuY2VsRnVsbFNjcmVlbiIsIndlYmtpdEV4aXRGdWxsc2NyZWVuIiwibXNFeGl0RnVsbHNjcmVlbiIsInNvbWUiLCJvcHRpb24iLCJmaWx0ZXJQYW5lRW5hYmxlZCIsImV2ZW50TmFtZSIsImV2ZW50RGF0YSIsImN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJyZXR1cm5WYWx1ZSIsImlubGluZUV2ZW50QXR0ciIsInJlcGxhY2UiLCJpbmxpbmVTY3JpcHQiLCJldmFsIiwiZmluZEluZGV4IiwicHJlZGljYXRlIiwieHMiLCJpc0FycmF5IiwiaW5kZXgiLCJpIiwic3BsaWNlIiwidGFyZ2V0IiwidW5kZWZpbmVkIiwiVHlwZUVycm9yIiwib3V0cHV0IiwiT2JqZWN0IiwibmV4dEtleSIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX3N1cGVyIiwiYXBwbHkiLCJyZXBvcnRJZCIsInRpbGVJZCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0FLVCxRQUFTQyxHQUFvQkMsR0FHNUIsR0FBR0MsRUFBaUJELEdBQ25CLE1BQU9DLEdBQWlCRCxHQUFVRSxPQUduQyxJQUFJQyxHQUFTRixFQUFpQkQsSUFDN0JFLFdBQ0FFLEdBQUlKLEVBQ0pLLFFBQVEsRUFVVCxPQU5BUCxHQUFRRSxHQUFVTSxLQUFLSCxFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTSCxHQUcvREksRUFBT0UsUUFBUyxFQUdURixFQUFPRCxRQXZCZixHQUFJRCxLQXFDSixPQVRBRixHQUFvQlEsRUFBSVQsRUFHeEJDLEVBQW9CUyxFQUFJUCxFQUd4QkYsRUFBb0JVLEVBQUksR0FHakJWLEVBQW9CLEtBSy9CLFNBQVNJLEVBQVFELEVBQVNILEdBRS9CLEdBQUlXLEdBQVNYLEVBQW9CLEVBTWpDWSxRQUFPQyxRQUFVRixFQUFPRyxRQUN4QkYsT0FBT0csUUFBVSxHQUFJSixHQUFPRyxTQUt2QixTQUFTVixFQUFRRCxFQUFTSCxHQUUvQixHQUFJZ0IsR0FBVWhCLEVBQW9CLEdBQzlCaUIsRUFBV2pCLEVBQW9CLEdBQy9Ca0IsRUFBU2xCLEVBQW9CLEdBQzdCbUIsRUFBU25CLEVBQW9CLEdBQzdCYyxFQUFXLFdBQ1gsUUFBU0EsR0FBUU0sR0FDRSxTQUFYQSxJQUFxQkEsTUFDekJDLEtBQUtDLFVBQ0xWLE9BQU9XLGlCQUFpQixVQUFXRixLQUFLRyxpQkFBaUJDLEtBQUtKLE9BQU8sR0FFckVBLEtBQUtELE9BQVNELEVBQU9PLE1BQU1DLFVBQVdiLEVBQVFjLGNBQWVSLEdBQ3pEQyxLQUFLRCxPQUFP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LEtBRS9FN0ksRUFBVWhCLEVBQW9CLEdBQzlCc0YsRUFBUSxTQUFVMEUsR0FFbEIsUUFBUzFFLEtBQ0wwRSxFQUFPQyxNQUFNNUksS0FBTXVFLFdBbUJ2QixNQXJCQThELEdBQVVwRSxFQUFNMEUsR0FJaEIxRSxFQUFLdkQsVUFBVXFFLFlBQWMsV0FDekIsR0FBSUQsR0FBVzZELEVBQU9qSSxVQUFVcUUsWUFBWTdGLEtBQUtjLEtBQ2pELE9BQU84RSxJQUVYYixFQUFLdkQsVUFBVXVDLEtBQU8sU0FBVTBCLEVBQVNRLEdBRXJDLEdBRGtCLFNBQWRBLElBQXdCQSxHQUFZLEdBQ3BDQSxHQUFtQyxnQkFBZlIsR0FBUTNGLEdBQzVCLEtBQU0sSUFBSW1ELE9BQU0sa0VBRXBCLElBQUlpRCxJQUNBRSxPQUFRLFdBQ1J3RCxPQUFRbkUsRUFBUTNGLEdBQ2hCOEQsWUFBYSxLQUVqQjZGLEdBQU9qSSxVQUFVdUMsS0FBSy9ELEtBQUtjLEtBQU0yRSxFQUFTUSxFQUFXQyxJQUV6RG5CLEVBQUt6QixLQUFPLE9BQ0x5QixHQUNUdEUsRUFBUTBCLE1BQ1Z2QyxHQUFRbUYsS0FBT0EiLCJmaWxlIjoicG93ZXJiaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIGNvcmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XHJcblx0LyoqXHJcblx0ICogTWFrZSBQb3dlckJpIGF2YWlsYWJsZSBvbiBnbG9iYWwgb2JqZWN0IGZvciB1c2UgaW4gYXBwcyB3aXRob3V0IG1vZHVsZSBsb2FkaW5nIHN1cHBvcnQuXHJcblx0ICogU2F2ZSBjbGFzcyB0byBhbGxvdyBjcmVhdGluZyBhbiBpbnN0YW5jZSBvZiB0aGUgc2VydmljZS5cclxuXHQgKiBDcmVhdGUgaW5zdGFuY2Ugb2YgY2xhc3Mgd2l0aCBkZWZhdWx0IGNvbmZpZyBmb3Igbm9ybWFsIHVzYWdlLlxyXG5cdCAqL1xyXG5cdHdpbmRvdy5Qb3dlcmJpID0gY29yZV8xLlBvd2VyQmk7XHJcblx0d2luZG93LnBvd2VyYmkgPSBuZXcgY29yZV8xLlBvd2VyQmkoKTtcclxuXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgZW1iZWRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XHJcblx0dmFyIHJlcG9ydF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcclxuXHR2YXIgdGlsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcclxuXHR2YXIgdXRpbF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcclxuXHR2YXIgUG93ZXJCaSA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIFBvd2VyQmkoY29uZmlnKSB7XHJcblx0ICAgICAgICBpZiAoY29uZmlnID09PSB2b2lkIDApIHsgY29uZmlnID0ge307IH1cclxuXHQgICAgICAgIHRoaXMuZW1iZWRzID0gW107XHJcblx0ICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25SZWNlaXZlTWVzc2FnZS5iaW5kKHRoaXMpLCBmYWxzZSk7XHJcblx0ICAgICAgICAvLyBUT0RPOiBDaGFuZ2Ugd2hlbiBPYmplY3QuYXNzaWduIGlzIGF2YWlsYWJsZS5cclxuXHQgICAgICAgIHRoaXMuY29uZmlnID0gdXRpbF8xLlV0aWxzLmFzc2lnbih7fSwgUG93ZXJCaS5kZWZhdWx0Q29uZmlnLCBjb25maWcpO1xyXG5cdCAgICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dG9FbWJlZE9uQ29udGVudExvYWRlZCkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuZW5hYmxlQXV0b0VtYmVkKCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIERPTUNvbnRlbnRMb2FkZWQgd2hpY2ggc2VhcmNoZXMgRE9NIGZvciBlbGVtZW50cyBoYXZpbmcgJ3Bvd2VyYmktZW1iZWQtdXJsJyBhdHRyaWJ1dGVcclxuXHQgICAgICogYW5kIGF1dG9tYXRpY2FsbHkgYXR0ZW1wdHMgdG8gZW1iZWQgYSBwb3dlcmJpIGNvbXBvbmVudCBiYXNlZCBvbiBpbmZvcm1hdGlvbiBmcm9tIHRoZSBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiBPbmx5IHJ1bnMgaWYgYGNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWRgIGlzIHRydWUgd2hlbiB0aGUgc2VydmljZSBpcyBjcmVhdGVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBjb250YWluZXIgPSAoY29udGFpbmVyICYmIGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHk7XHJcblx0ICAgICAgICB2YXIgZWxlbWVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIltcIiArIGVtYmVkXzEuRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgKyBcIl1cIikpO1xyXG5cdCAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gX3RoaXMuZW1iZWQoZWxlbWVudCk7IH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gaHRtbCBlbGVtZW50IGVtYmVkIGNvbXBvbmVudCBiYXNlZCBvbiBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKiBJZiBjb21wb25lbnQgaGFzIGFscmVhZHkgYmVlbiBjcmVhdGVkIGFuZCBhdHRhY2hlZCB0byBlbGVtZW50IHJlLXVzZSBjb21wb25lbnQgaW5zdGFuY2UgYW5kIGV4aXN0aW5nIGlmcmFtZSxcclxuXHQgICAgICogb3RoZXJ3aXNlIGNyZWF0ZSBhIG5ldyBjb21wb25lbnQgaW5zdGFuY2VcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVtYmVkID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZyA9PT0gdm9pZCAwKSB7IGNvbmZpZyA9IHt9OyB9XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50O1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmIChwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQpIHtcclxuXHQgICAgICAgICAgICBjb21wb25lbnQgPSB0aGlzLmVtYmVkRXhpc3RpbmcocG93ZXJCaUVsZW1lbnQsIGNvbmZpZyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICBjb21wb25lbnQgPSB0aGlzLmVtYmVkTmV3KHBvd2VyQmlFbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdpdmVuIGFuIGh0bWwgZWxlbWVudCBlbWJlZCBjb21wb25lbnQgYmFzZSBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKiBTYXZlIGNvbXBvbmVudCBpbnN0YW5jZSBvbiBlbGVtZW50IGZvciBsYXRlciBsb29rdXAuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbWJlZE5ldyA9IGZ1bmN0aW9uIChlbGVtZW50LCBjb25maWcpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50VHlwZSA9IGNvbmZpZy50eXBlIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGVtYmVkXzEuRW1iZWQudHlwZUF0dHJpYnV0ZSk7XHJcblx0ICAgICAgICBpZiAoIWNvbXBvbmVudFR5cGUpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZW1iZWQgdXNpbmcgY29uZmlnIFwiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSArIFwiIG9uIGVsZW1lbnQgXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiLCBidXQgY291bGQgbm90IGRldGVybWluZSB3aGF0IHR5cGUgb2YgY29tcG9uZW50IHRvIGVtYmVkLiBZb3UgbXVzdCBzcGVjaWZ5IGEgdHlwZSBpbiB0aGUgY29uZmlndXJhdGlvbiBvciBhcyBhbiBhdHRyaWJ1dGUgc3VjaCBhcyAnXCIgKyBlbWJlZF8xLkVtYmVkLnR5cGVBdHRyaWJ1dGUgKyBcIj1cXFwiXCIgKyByZXBvcnRfMS5SZXBvcnQubmFtZS50b0xvd2VyQ2FzZSgpICsgXCJcXFwiJy5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvLyBTYXZlIHR5cGUgb24gY29uZmlndXJhdGlvbiBzbyBpdCBjYW4gYmUgcmVmZXJlbmNlZCBsYXRlciBhdCBrbm93biBsb2NhdGlvblxyXG5cdCAgICAgICAgY29uZmlnLnR5cGUgPSBjb21wb25lbnRUeXBlO1xyXG5cdCAgICAgICAgdmFyIENvbXBvbmVudCA9IHV0aWxfMS5VdGlscy5maW5kKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIGNvbXBvbmVudFR5cGUgPT09IGNvbXBvbmVudC5uYW1lLnRvTG93ZXJDYXNlKCk7IH0sIFBvd2VyQmkuY29tcG9uZW50cyk7XHJcblx0ICAgICAgICBpZiAoIUNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCBjb21wb25lbnQgb2YgdHlwZTogXCIgKyBjb21wb25lbnRUeXBlICsgXCIgYnV0IGRpZCBub3QgZmluZCBhbnkgbWF0Y2hpbmcgY29tcG9uZW50LiAgUGxlYXNlIHZlcmlmeSB0aGUgdHlwZSB5b3Ugc3BlY2lmaWVkIGlzIGludGVuZGVkLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIHJlbW92aW5nIGluIGZhdm9yIG9mIHBhc3NpbmcgcmVmZXJlbmNlIHRvIGB0aGlzYCBpbiBjb25zdHJ1Y3RvclxyXG5cdCAgICAgICAgLy8gVGhlIGdldEdsb2JhbEFjY2Vzc1Rva2VuIGZ1bmN0aW9uIGlzIG9ubHkgaGVyZSBzbyB0aGF0IHRoZSBjb21wb25lbnRzIChUaWxlIHwgUmVwb3J0KSBjYW4gZ2V0IHRoZSBnbG9iYWwgYWNjZXNzIHRva2VuIHdpdGhvdXQgbmVlZGluZyByZWZlcmVuY2VcclxuXHQgICAgICAgIC8vIHRvIHRoZSBzZXJ2aWNlIHRoYXQgdGhleSBhcmUgcmVnaXN0ZXJlZCB3aXRoaW4gYmVjYXVlcyBpdCBjcmVhdGVzIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xyXG5cdCAgICAgICAgY29uZmlnLmdldEdsb2JhbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYWNjZXNzVG9rZW47IH07XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50ID0gbmV3IENvbXBvbmVudChlbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICAgICAgZWxlbWVudC5wb3dlckJpRW1iZWQgPSBjb21wb25lbnQ7XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcy5wdXNoKGNvbXBvbmVudCk7XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbWJlZEV4aXN0aW5nID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIGNvbXBvbmVudCA9IHV0aWxfMS5VdGlscy5maW5kKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmVsZW1lbnQgPT09IGVsZW1lbnQ7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgICAgIGlmICghY29tcG9uZW50KSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIHVzaW5nIGNvbmZpZyBcIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykgKyBcIiBvbiBlbGVtZW50IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiB3aGljaCBhbHJlYWR5IGhhcyBlbWJlZGRlZCBjb21vcG5lbnQgYXNzb2NpYXRlZCwgYnV0IGNvdWxkIG5vdCBmaW5kIHRoZSBleGlzdGluZyBjb21vcG5lbnQgaW4gdGhlIGxpc3Qgb2YgYWN0aXZlIGNvbXBvbmVudHMuIFRoaXMgY291bGQgaW5kaWNhdGUgdGhlIGVtYmVkcyBsaXN0IGlzIG91dCBvZiBzeW5jIHdpdGggdGhlIERPTSwgb3IgdGhlIGNvbXBvbmVudCBpcyByZWZlcmVuY2luZyB0aGUgaW5jb3JyZWN0IEhUTUwgZWxlbWVudC5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBjb21wb25lbnQubG9hZChjb25maWcsIHRydWUpO1xyXG5cdCAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgRE9NQ29udGVudExvYWRlZCB3aGljaCBmaW5kcyBhbGwgZWxlbWVudHMgaW4gRE9NIHdpdGggYXR0cmlidXRlIHBvd2VyYmktZW1iZWQtdXJsXHJcblx0ICAgICAqIHRoZW4gYXR0ZW1wdHMgdG8gaW5pdGlhdGUgdGhlIGVtYmVkIHByb2Nlc3MgYmFzZWQgb24gZGF0YSBmcm9tIG90aGVyIHBvd2VyYmktKiBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiAoVGhpcyBpcyB1c3VhbGx5IG9ubHkgdXNlZnVsIGZvciBhcHBsaWNhdGlvbnMgcmVuZGVyZWQgb24gYnkgdGhlIHNlcnZlciBzaW5jZSBhbGwgdGhlIGRhdGEgbmVlZGVkIHdpbGwgYmUgYXZhaWxhYmxlIGJ5IHRoZSB0aW1lIHRoZSBoYW5kbGVyIGlzIGNhbGxlZC4pXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbmFibGVBdXRvRW1iZWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmluaXQoZG9jdW1lbnQuYm9keSk7IH0sIGZhbHNlKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJldHVybnMgaW5zdGFuY2Ugb2YgY29tcG9uZW50IGFzc29jaWF0ZWQgd2l0aCBlbGVtZW50LlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHZhciBwb3dlckJpRWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0ICAgICAgICBpZiAoIXBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBhdHRlbXB0ZWQgdG8gZ2V0IGFuIGluc3RhbmNlIG9mIHBvd2VyYmkgY29tcG9uZW50IGFzc29jaWF0ZWQgd2l0aCBlbGVtZW50OiBcIiArIGVsZW1lbnQub3V0ZXJIVE1MICsgXCIgYnV0IHRoZXJlIHdhcyBubyBhc3NvY2lhdGVkIGluc3RhbmNlLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQ7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgd2hpY2ggaGFzIGNvbXBvbmVudCBlbWJlZGRlZCB3aXRoaW4gaXQsIHJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gbGlzdCBvZiBlbWJlZHMsIHJlbW92ZSBhc3NvY2lhdGlvbiB3aXRoIGNvbXBvbmVudCwgYW5kIHJlbW92ZSB0aGUgaWZyYW1lLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLyoqIFJlbW92ZSBjb21wb25lbnQgZnJvbSBpbnRlcm5hbCBsaXN0ICovXHJcblx0ICAgICAgICB1dGlsXzEuVXRpbHMucmVtb3ZlKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4ID09PSBwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQ7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgICAgIC8qKiBEZWxldGUgcHJvcGVydHkgZnJvbSBodG1sIGVsZW1lbnQgKi9cclxuXHQgICAgICAgIGRlbGV0ZSBwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQ7XHJcblx0ICAgICAgICAvKiogUmVtb3ZlIGlmcmFtZSBmcm9tIGVsZW1lbnQgKi9cclxuXHQgICAgICAgIHZhciBpZnJhbWUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpO1xyXG5cdCAgICAgICAgaWYgKGlmcmFtZSkge1xyXG5cdCAgICAgICAgICAgIGlmcmFtZS5yZW1vdmUoKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIHdpbmRvdyBtZXNzYWdlIGV2ZW50LlxyXG5cdCAgICAgKiBQYXJzZXMgZXZlbnQgZGF0YSBhcyBqc29uIGFuZCBpZiBpdCBjYW1lIGZyb20gYW4gaWZyYW1lIHRoYXQgbWF0Y2hlcyBvbmUgZnJvbSBhbiBleGlzdGluZyBlbWJlZGVkIGNvbXBvbmVudCByZS1kaXNwYXRjaGVzIHRoZSBldmVudCBvbiB0aGUgaWZyYW1lJ3MgcGFyZW50IGVsZW1lbnRcclxuXHQgICAgICogdG8gc2ltdWxhdGUgdGhlIGV2ZW50IGJ1YmJsaW5nIHRocm91Z2ggdGhlIHR3byBzZXBhcmF0ZSB3aW5kb3dzIC8gRE9Ncy5cclxuXHQgICAgICpcclxuXHQgICAgICogSWYgYW4gZXJyb3Igb2NjdXJzIHdoZW4gcGFyc2luZyBldmVudC5kYXRhIGNhbGwgZXJyb3IgaGFuZGxlciBwcm92aWRlZCBkdXJpbmcgY29uZmlndXJhdGlvbi5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLm9uUmVjZWl2ZU1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHQgICAgICAgIGlmICghZXZlbnQpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB0cnkge1xyXG5cdCAgICAgICAgICAgIC8vIE9ubHkgcmFpc2UgdGhlIGV2ZW50IG9uIHRoZSBlbWJlZCB0aGF0IG1hdGNoZXMgdGhlIHBvc3QgbWVzc2FnZSBvcmlnaW5cclxuXHQgICAgICAgICAgICB2YXIgZW1iZWQgPSB1dGlsXzEuVXRpbHMuZmluZChmdW5jdGlvbiAoZW1iZWQpIHsgcmV0dXJuIGV2ZW50LnNvdXJjZSA9PT0gZW1iZWQuaWZyYW1lLmNvbnRlbnRXaW5kb3c7IH0sIHRoaXMuZW1iZWRzKTtcclxuXHQgICAgICAgICAgICBpZiAoZW1iZWQpIHtcclxuXHQgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VEYXRhID0gdHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShldmVudC5kYXRhKSA6IGV2ZW50LmRhdGE7XHJcblx0ICAgICAgICAgICAgICAgIHV0aWxfMS5VdGlscy5yYWlzZUN1c3RvbUV2ZW50KGVtYmVkLmVsZW1lbnQsIFBvd2VyQmkuZXZlbnRNYXBbbWVzc2FnZURhdGEuZXZlbnRdLCBtZXNzYWdlRGF0YSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgY2F0Y2ggKGUpIHtcclxuXHQgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29uZmlnLm9uRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICAgICAgdGhpcy5jb25maWcub25FcnJvci5jYWxsKHdpbmRvdywgZSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIExpc3Qgb2YgY29tcG9uZW50cyB0aGlzIHNlcnZpY2UgY2FuIGVtYmVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5jb21wb25lbnRzID0gW1xyXG5cdCAgICAgICAgdGlsZV8xLlRpbGUsXHJcblx0ICAgICAgICByZXBvcnRfMS5SZXBvcnRcclxuXHQgICAgXTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIE1hcHBpbmcgb2YgZXZlbnQgbmFtZXMgZnJvbSBpZnJhbWUgcG9zdE1lc3NhZ2UgdG8gdGhlaXIgbmFtZSBwZXJjaWV2ZWQgYnkgcGFyZW50IERPTS5cclxuXHQgICAgICogRXhhbXBsZTogVXNlciBjbGlja3Mgb24gZW1iZWRlZCByZXBvcnQgd2hpY2ggaXMgaW5zaWRlIGlmcmFtZS4gVGhlIGlmcmFtZSBjb2RlIHJlc2VuZHNcclxuXHQgICAgICogZXZlbnQgYXMgcG9zdE1lc3NhZ2Ugd2l0aCB7IGV2ZW50OiAncmVwb3J0Q2xpY2tlZCcsIC4uLiB9IGFuZCB0aGlzIG5hbWUgaXMgY29udmVydGVkIHRvIGh5cGhlbmF0ZWRcclxuXHQgICAgICogbmFtZSBhbmQgZGlzcGF0Y2hlZCBmcm9tIHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgaWZyYW1lIHRvIHNpbXVsYXRlIHRoZSBldmVudCBidWJibGluZyB0aHJvdWdoIHR3b1xyXG5cdCAgICAgKiBkaWZmZXJlbnQgd2luZG93cyAvIERPTXNcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkuZXZlbnRNYXAgPSB7XHJcblx0ICAgICAgICAndGlsZUNsaWNrZWQnOiAndGlsZS1jbGljaycsXHJcblx0ICAgICAgICAndGlsZUxvYWRlZCc6ICd0aWxlLWxvYWQnLFxyXG5cdCAgICAgICAgJ3JlcG9ydFBhZ2VMb2FkZWQnOiAncmVwb3J0LWxvYWQnXHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBEZWZhdWx0IGNvbmZpZ3VyYXRpb24gZm9yIHNlcnZpY2UuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLmRlZmF1bHRDb25maWcgPSB7XHJcblx0ICAgICAgICBhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQ6IGZhbHNlLFxyXG5cdCAgICAgICAgb25FcnJvcjogZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcblx0ICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuXHQgICAgICAgICAgICAgICAgYXJnc1tfaSAtIDBdID0gYXJndW1lbnRzW19pXTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGFyZ3NbMF0sIGFyZ3Muc2xpY2UoMSkpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gUG93ZXJCaTtcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuUG93ZXJCaSA9IFBvd2VyQmk7XHJcblx0Ly8gZXhwb3J0IGRlZmF1bHQgUG93ZXJCaTsgXHJcblxuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcblx0dmFyIEVtYmVkID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gRW1iZWQoZWxlbWVudCwgb3B0aW9ucykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0ICAgICAgICAvLyBUT0RPOiBDaGFuZ2Ugd2hlbiBPYmplY3QuYXNzaWduIGlzIGF2YWlsYWJsZS5cclxuXHQgICAgICAgIHRoaXMub3B0aW9ucyA9IHV0aWxfMS5VdGlscy5hc3NpZ24oe30sIEVtYmVkLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5lbWJlZFVybCA9IHRoaXMuZ2V0RW1iZWRVcmwoKTtcclxuXHQgICAgICAgIHZhciBpZnJhbWVIdG1sID0gXCI8aWZyYW1lIHN0eWxlPVxcXCJ3aWR0aDoxMDAlO2hlaWdodDoxMDAlO1xcXCIgc3JjPVxcXCJcIiArIHRoaXMub3B0aW9ucy5lbWJlZFVybCArIFwiXFxcIiBzY3JvbGxpbmc9XFxcIm5vXFxcIiBhbGxvd2Z1bGxzY3JlZW49XFxcInRydWVcXFwiPjwvaWZyYW1lPlwiO1xyXG5cdCAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGlmcmFtZUh0bWw7XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZSA9IHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzWzBdO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmxvYWQoX3RoaXMub3B0aW9ucywgZmFsc2UpOyB9LCBmYWxzZSk7XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIHdoZW4gdGhlIGlmcmFtZSBoYXMgZmluaXNoZWQgbG9hZGluZyB0aGUgcG93ZXJiaSBwbGFjZWhvbGRlciBwYWdlLlxyXG5cdCAgICAgKiBUaGlzIGlzIHVzZWQgdG8gaW5qZWN0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBzdWNoIGFzIGFjY2VzcyB0b2tlbiwgbG9hZEFjdGlvbiwgZXRjXHJcblx0ICAgICAqIHdoaWNoIGFsbG93IGlmcmFtZSB0byBsb2FkIHRoZSBhY3R1YWwgcmVwb3J0IHdpdGggYXV0aGVudGljYXRpb24uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpIHtcclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxyXG5cdCAgICAgICAgaWYgKG1lc3NhZ2UgPT09IHZvaWQgMCkgeyBtZXNzYWdlID0gbnVsbDsgfVxyXG5cdCAgICAgICAgaWYgKCFtZXNzYWdlKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGNhbGxlZCBsb2FkIHdpdGhvdXQgcHJvdmlkaW5nIG1lc3NhZ2UgcHJvcGVydGllcyBmcm9tIHRoZSBjb25jcmV0ZSBlbWJlZGRhYmxlIGNsYXNzLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBiYXNlTWVzc2FnZSA9IHtcclxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogb3B0aW9ucy5hY2Nlc3NUb2tlblxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5VdGlscy5hc3NpZ24obWVzc2FnZSwgYmFzZU1lc3NhZ2UpO1xyXG5cdCAgICAgICAgdmFyIGV2ZW50ID0ge1xyXG5cdCAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcclxuXHQgICAgICAgIH07XHJcblx0ICAgICAgICB1dGlsXzEuVXRpbHMucmFpc2VDdXN0b21FdmVudCh0aGlzLmVsZW1lbnQsIGV2ZW50Lm1lc3NhZ2UuYWN0aW9uLCBldmVudCk7XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KGV2ZW50Lm1lc3NhZ2UpLCAnKicpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2V0IGFjY2VzcyB0b2tlbiBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLCBnbG9iYWwuXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgYWNjZXNzVG9rZW4gPSB0aGlzLm9wdGlvbnMuYWNjZXNzVG9rZW4gfHwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSkgfHwgdGhpcy5vcHRpb25zLmdldEdsb2JhbEFjY2Vzc1Rva2VuKCk7XHJcblx0ICAgICAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYWNjZXNzIHRva2VuIHdhcyBmb3VuZCBmb3IgZWxlbWVudC4gWW91IG11c3Qgc3BlY2lmeSBhbiBhY2Nlc3MgdG9rZW4gZGlyZWN0bHkgb24gdGhlIGVsZW1lbnQgdXNpbmcgYXR0cmlidXRlICdcIiArIEVtYmVkLmFjY2Vzc1Rva2VuQXR0cmlidXRlICsgXCInIG9yIHNwZWNpZnkgYSBnbG9iYWwgdG9rZW4gYXQ6IHBvd2VyYmkuYWNjZXNzVG9rZW4uXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2V0IGVtYmVkIHVybCBmcm9tIGZpcnN0IGF2YWlsYWJsZSBsb2NhdGlvbjogb3B0aW9ucywgYXR0cmlidXRlLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmdldEVtYmVkVXJsID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gdGhpcy5vcHRpb25zLmVtYmVkVXJsIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUpO1xyXG5cdCAgICAgICAgaWYgKHR5cGVvZiBlbWJlZFVybCAhPT0gJ3N0cmluZycgfHwgZW1iZWRVcmwubGVuZ3RoID09PSAwKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1iZWQgVXJsIGlzIHJlcXVpcmVkLCBidXQgaXQgd2FzIG5vdCBmb3VuZC4gWW91IG11c3QgcHJvdmlkZSBhbiBlbWJlZCB1cmwgZWl0aGVyIGFzIHBhcnQgb2YgZW1iZWQgY29uZmlndXJhdGlvbiBvciBhcyBhdHRyaWJ1dGUgJ1wiICsgRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgKyBcIicuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGVtYmVkVXJsO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmVxdWVzdCB0aGUgYnJvd3NlciB0byBtYWtlIHRoZSBjb21wb25lbnRzIGlmcmFtZSBmdWxsc2NyZWVuLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgcmVxdWVzdEZ1bGxTY3JlZW4gPSB0aGlzLmlmcmFtZS5yZXF1ZXN0RnVsbHNjcmVlbiB8fCB0aGlzLmlmcmFtZS5tc1JlcXVlc3RGdWxsc2NyZWVuIHx8IHRoaXMuaWZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuIHx8IHRoaXMuaWZyYW1lLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuO1xyXG5cdCAgICAgICAgcmVxdWVzdEZ1bGxTY3JlZW4uY2FsbCh0aGlzLmlmcmFtZSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBFeGl0IGZ1bGxzY3JlZW4uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuZXhpdEZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICBpZiAoIXRoaXMuaXNGdWxsc2NyZWVuKHRoaXMuaWZyYW1lKSkge1xyXG5cdCAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBleGl0RnVsbHNjcmVlbiA9IGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuIHx8IGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4gfHwgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcclxuXHQgICAgICAgIGV4aXRGdWxsc2NyZWVuLmNhbGwoZG9jdW1lbnQpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmV0dXJuIHRydWUgaWYgaWZyYW1lIGlzIGZ1bGxzY3JlZW4sXHJcblx0ICAgICAqIG90aGVyd2lzZSByZXR1cm4gZmFsc2VcclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5pc0Z1bGxzY3JlZW4gPSBmdW5jdGlvbiAoaWZyYW1lKSB7XHJcblx0ICAgICAgICB2YXIgb3B0aW9ucyA9IFsnZnVsbHNjcmVlbkVsZW1lbnQnLCAnd2Via2l0RnVsbHNjcmVlbkVsZW1lbnQnLCAnbW96RnVsbHNjcmVlblNjcmVlbkVsZW1lbnQnLCAnbXNGdWxsc2NyZWVuRWxlbWVudCddO1xyXG5cdCAgICAgICAgcmV0dXJuIG9wdGlvbnMuc29tZShmdW5jdGlvbiAob3B0aW9uKSB7IHJldHVybiBkb2N1bWVudFtvcHRpb25dID09PSBpZnJhbWU7IH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICBFbWJlZC5lbWJlZFVybEF0dHJpYnV0ZSA9ICdwb3dlcmJpLWVtYmVkLXVybCc7XHJcblx0ICAgIEVtYmVkLmFjY2Vzc1Rva2VuQXR0cmlidXRlID0gJ3Bvd2VyYmktYWNjZXNzLXRva2VuJztcclxuXHQgICAgRW1iZWQudHlwZUF0dHJpYnV0ZSA9ICdwb3dlcmJpLXR5cGUnO1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRGVmYXVsdCBvcHRpb25zIGZvciBlbWJlZGRhYmxlIGNvbXBvbmVudC5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLmRlZmF1bHRPcHRpb25zID0ge1xyXG5cdCAgICAgICAgZmlsdGVyUGFuZUVuYWJsZWQ6IHRydWVcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIEVtYmVkO1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5FbWJlZCA9IEVtYmVkO1xyXG5cblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdHZhciBVdGlscyA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIFV0aWxzKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIFV0aWxzLnJhaXNlQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnROYW1lLCBldmVudERhdGEpIHtcclxuXHQgICAgICAgIHZhciBjdXN0b21FdmVudDtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgQ3VzdG9tRXZlbnQgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcclxuXHQgICAgICAgICAgICAgICAgZGV0YWlsOiBldmVudERhdGEsXHJcblx0ICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcblx0ICAgICAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWVcclxuXHQgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIGN1c3RvbUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XHJcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSwgZXZlbnREYXRhKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XHJcblx0ICAgICAgICBpZiAoY3VzdG9tRXZlbnQuZGVmYXVsdFByZXZlbnRlZCB8fCAhY3VzdG9tRXZlbnQucmV0dXJuVmFsdWUpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhpcz8gU2hvdWxkIGJlIGJldHRlciB3YXkgdG8gaGFuZGxlIGV2ZW50cyB0aGFuIHVzaW5nIGV2YWw/XHJcblx0ICAgICAgICAvLyBXaGF0IGlzIHVzZSBjYXNlPyA8ZGl2IHBvd2VyYmktdHlwZT1cInJlcG9ydFwiIG9ubG9hZD1cImFsZXJ0KCdsb2FkZWQnKTtcIj48L2Rpdj5cclxuXHQgICAgICAgIHZhciBpbmxpbmVFdmVudEF0dHIgPSAnb24nICsgZXZlbnROYW1lLnJlcGxhY2UoJy0nLCAnJyk7XHJcblx0ICAgICAgICB2YXIgaW5saW5lU2NyaXB0ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoaW5saW5lRXZlbnRBdHRyKTtcclxuXHQgICAgICAgIGlmIChpbmxpbmVTY3JpcHQpIHtcclxuXHQgICAgICAgICAgICBldmFsLmNhbGwoZWxlbWVudCwgaW5saW5lU2NyaXB0KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgVXRpbHMuZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh4cykpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXR0ZW1wdGVkIHRvIGNhbGwgZmluZCB3aXRoIHNlY29uZCBwYXJhbWV0ZXIgdGhhdCB3YXMgbm90IGFuIGFycmF5LiBZb3UgcGFzc2VkOiBcIiArIHhzKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBpbmRleDtcclxuXHQgICAgICAgIHhzLnNvbWUoZnVuY3Rpb24gKHgsIGkpIHtcclxuXHQgICAgICAgICAgICBpZiAocHJlZGljYXRlKHgpKSB7XHJcblx0ICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfSk7XHJcblx0ICAgICAgICByZXR1cm4gaW5kZXg7XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmQgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB4cykge1xyXG5cdCAgICAgICAgdmFyIGluZGV4ID0gVXRpbHMuZmluZEluZGV4KHByZWRpY2F0ZSwgeHMpO1xyXG5cdCAgICAgICAgcmV0dXJuIHhzW2luZGV4XTtcclxuXHQgICAgfTtcclxuXHQgICAgVXRpbHMucmVtb3ZlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcclxuXHQgICAgICAgIHhzLnNwbGljZShpbmRleCwgMSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2Fzc2lnblxyXG5cdCAgICAvLyBUT0RPOiByZXBsYWNlIGluIGZhdm9yIG9mIHVzaW5nIHBvbHlmaWxsXHJcblx0ICAgIFV0aWxzLmFzc2lnbiA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBhcmdzID0gW107XHJcblx0ICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG5cdCAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgdGFyZ2V0ID0gYXJnc1swXTtcclxuXHQgICAgICAgICd1c2Ugc3RyaWN0JztcclxuXHQgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBvdXRwdXQgPSBPYmplY3QodGFyZ2V0KTtcclxuXHQgICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcblx0ICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XHJcblx0ICAgICAgICAgICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkICYmIHNvdXJjZSAhPT0gbnVsbCkge1xyXG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBuZXh0S2V5IGluIHNvdXJjZSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShuZXh0S2V5KSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtuZXh0S2V5XSA9IHNvdXJjZVtuZXh0S2V5XTtcclxuXHQgICAgICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBvdXRwdXQ7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBVdGlscztcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuVXRpbHMgPSBVdGlscztcclxuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcblx0ICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuXHQgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG5cdH07XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciBSZXBvcnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG5cdCAgICBfX2V4dGVuZHMoUmVwb3J0LCBfc3VwZXIpO1xyXG5cdCAgICBmdW5jdGlvbiBSZXBvcnQoKSB7XHJcblx0ICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHQgICAgfVxyXG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmdldEVtYmVkVXJsID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGVtYmVkVXJsID0gX3N1cGVyLnByb3RvdHlwZS5nZXRFbWJlZFVybC5jYWxsKHRoaXMpO1xyXG5cdCAgICAgICAgLy8gVE9ETzogTmVlZCBzYWZlIHdheSB0byBhZGQgdXJsIHBhcmFtZXRlcnMuXHJcblx0ICAgICAgICAvLyBXZSBhcmUgYXNzdW1pbmcgZW1iZWRVcmxzIHVzZSBxdWVyeSBwYXJhbWV0ZXJzIHRvIHN1cHBseSBpZCBvZiB2aXN1YWxcclxuXHQgICAgICAgIC8vIHNvIG11c3QgcHJlZml4IHdpdGggJyYnLlxyXG5cdCAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmlsdGVyUGFuZUVuYWJsZWQpIHtcclxuXHQgICAgICAgICAgICBlbWJlZFVybCArPSBcIiZmaWx0ZXJQYW5lRW5hYmxlZD1mYWxzZVwiO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIGVtYmVkVXJsO1xyXG5cdCAgICB9O1xyXG5cdCAgICBSZXBvcnQucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVxdWlyZUlkKSB7XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkID09PSB2b2lkIDApIHsgcmVxdWlyZUlkID0gZmFsc2U7IH1cclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgJiYgdHlwZW9mIG9wdGlvbnMuaWQgIT09ICdzdHJpbmcnKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBsb2FkaW5nIHJlcG9ydHMgb24gZXhpc3RpbmcgZWxlbWVudHMuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XHJcblx0ICAgICAgICAgICAgYWN0aW9uOiAnbG9hZFJlcG9ydCcsXHJcblx0ICAgICAgICAgICAgcmVwb3J0SWQ6IG9wdGlvbnMuaWQsXHJcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IG51bGxcclxuXHQgICAgICAgIH07XHJcblx0ICAgICAgICBfc3VwZXIucHJvdG90eXBlLmxvYWQuY2FsbCh0aGlzLCBvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBSZXBvcnQubmFtZSA9IFwiUmVwb3J0XCI7XHJcblx0ICAgIHJldHVybiBSZXBvcnQ7XHJcblx0fShlbWJlZF8xLkVtYmVkKSk7XHJcblx0ZXhwb3J0cy5SZXBvcnQgPSBSZXBvcnQ7XHJcblxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuXHR9O1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgVGlsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcblx0ICAgIF9fZXh0ZW5kcyhUaWxlLCBfc3VwZXIpO1xyXG5cdCAgICBmdW5jdGlvbiBUaWxlKCkge1xyXG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0ICAgIH1cclxuXHQgICAgVGlsZS5wcm90b3R5cGUuZ2V0RW1iZWRVcmwgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgZW1iZWRVcmwgPSBfc3VwZXIucHJvdG90eXBlLmdldEVtYmVkVXJsLmNhbGwodGhpcyk7XHJcblx0ICAgICAgICByZXR1cm4gZW1iZWRVcmw7XHJcblx0ICAgIH07XHJcblx0ICAgIFRpbGUucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVxdWlyZUlkKSB7XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkID09PSB2b2lkIDApIHsgcmVxdWlyZUlkID0gZmFsc2U7IH1cclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgJiYgdHlwZW9mIG9wdGlvbnMuaWQgIT09ICdzdHJpbmcnKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBsb2FkaW5nIHJlcG9ydHMgb24gZXhpc3RpbmcgZWxlbWVudHMuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XHJcblx0ICAgICAgICAgICAgYWN0aW9uOiAnbG9hZFRpbGUnLFxyXG5cdCAgICAgICAgICAgIHRpbGVJZDogb3B0aW9ucy5pZCxcclxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogbnVsbFxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIF9zdXBlci5wcm90b3R5cGUubG9hZC5jYWxsKHRoaXMsIG9wdGlvbnMsIHJlcXVpcmVJZCwgbWVzc2FnZSk7XHJcblx0ICAgIH07XHJcblx0ICAgIFRpbGUubmFtZSA9IFwiVGlsZVwiO1xyXG5cdCAgICByZXR1cm4gVGlsZTtcclxuXHR9KGVtYmVkXzEuRW1iZWQpKTtcclxuXHRleHBvcnRzLlRpbGUgPSBUaWxlO1xyXG5cblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wb3dlcmJpLmpzLm1hcCJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
