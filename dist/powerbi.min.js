!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var o=n(1);window.Powerbi=o["default"],window.powerbi=new o["default"]},function(e,t,n){"use strict";var o=n(2),r=n(4),i=n(5),s=n(3),a=function(){function e(t){void 0===t&&(t={}),this.embeds=[],window.addEventListener("message",this.onReceiveMessage.bind(this),!1),this.config=s["default"].assign({},e.defaultConfig,t),this.config.autoEmbedOnContentLoaded&&this.enableAutoEmbed()}return e.prototype.init=function(e){var t=this;e=e&&e instanceof HTMLElement?e:document.body;var n=Array.prototype.slice.call(e.querySelectorAll("["+o["default"].embedUrlAttribute+"]"));n.forEach(function(e){return t.embed(e)})},e.prototype.embed=function(e,t){void 0===t&&(t={});var n,o=e;return n=o.powerBiEmbed?this.embedExisting(o,t):this.embedNew(o,t)},e.prototype.embedNew=function(t,n){var i=this,a=n.type||t.getAttribute(o["default"].typeAttribute);if(!a)throw new Error("Attempted to embed using config "+JSON.stringify(n)+" on element "+t.outerHTML+", but could not determine what type of component to embed. You must specify a type in the configuration or as an attribute such as '"+o["default"].typeAttribute+'="'+r["default"].name.toLowerCase()+"\"'.");n.type=a;var u=s["default"].find(function(e){return a===e.name.toLowerCase()},e.components);if(!u)throw new Error("Attempted to embed component of type: "+a+" but did not find any matching component.  Please verify the type you specified is intended.");n.getGlobalAccessToken=function(){return i.accessToken};var c=new u(t,n);return t.powerBiEmbed=c,this.embeds.push(c),c},e.prototype.embedExisting=function(e,t){var n=s["default"].find(function(t){return t.element===e},this.embeds);if(!n)throw new Error("Attempted to embed using config "+JSON.stringify(t)+" on element "+e.outerHTML+" which already has embedded comopnent associated, but could not find the existing comopnent in the list of active components. This could indicate the embeds list is out of sync with the DOM, or the component is referencing the incorrect HTML element.");return n.load(t,!0),n},e.prototype.enableAutoEmbed=function(){var e=this;window.addEventListener("DOMContentLoaded",function(t){return e.init(document.body)},!1)},e.prototype.get=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");return t.powerBiEmbed},e.prototype.reset=function(e){var t=e;if(!t.powerBiEmbed)throw new Error("You attempted to get an instance of powerbi component associated with element: "+e.outerHTML+" but there was no associated instance.");s["default"].remove(function(e){return e===t.powerBiEmbed},this.embeds),delete t.powerBiEmbed;var n=e.querySelector("iframe");n&&n.remove()},e.prototype.onReceiveMessage=function(t){if(t)try{var n=s["default"].find(function(e){return t.source===e.iframe.contentWindow},this.embeds);if(n){var o="string"==typeof t.data?JSON.parse(t.data):t.data;s["default"].raiseCustomEvent(n.element,e.eventMap[o.event],o)}}catch(r){if("function"!=typeof this.config.onError)throw r;this.config.onError.call(window,r)}},e.components=[i["default"],r["default"]],e.eventMap={tileClicked:"tile-click",tileLoaded:"tile-load",reportPageLoaded:"report-load"},e.defaultConfig={autoEmbedOnContentLoaded:!1,onError:function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return console.log(e[0],e.slice(1))}},e}();t.PowerBi=a,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a},function(e,t,n){"use strict";var o=n(3),r=function(){function e(t,n){var r=this;this.element=t,this.options=o["default"].assign({},e.defaultOptions,n),this.options.accessToken=this.getAccessToken(),this.options.embedUrl=this.getEmbedUrl();var i='<iframe style="width:100%;height:100%;" src="'+this.options.embedUrl+'" scrolling="no" allowfullscreen="true"></iframe>';this.element.innerHTML=i,this.iframe=this.element.childNodes[0],this.iframe.addEventListener("load",function(){return r.load(r.options,!1)},!1)}return e.prototype.load=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=null),!n)throw new Error("You called load without providing message properties from the concrete embeddable class.");var r={accessToken:e.accessToken};o["default"].assign(n,r);var i={message:n};o["default"].raiseCustomEvent(this.element,i.message.action,i),this.iframe.contentWindow.postMessage(JSON.stringify(i.message),"*")},e.prototype.getAccessToken=function(){var t=this.options.accessToken||this.element.getAttribute(e.accessTokenAttribute)||this.options.getGlobalAccessToken();if(!t)throw new Error("No access token was found for element. You must specify an access token directly on the element using attribute '"+e.accessTokenAttribute+"' or specify a global token at: powerbi.accessToken.");return t},e.prototype.getEmbedUrl=function(){var t=this.options.embedUrl||this.element.getAttribute(e.embedUrlAttribute);if("string"!=typeof t||0===t.length)throw new Error("Embed Url is required, but it was not found. You must provide an embed url either as part of embed configuration or as attribute '"+e.embedUrlAttribute+"'.");return t},e.prototype.fullscreen=function(){var e=this.iframe.requestFullscreen||this.iframe.msRequestFullscreen||this.iframe.mozRequestFullScreen||this.iframe.webkitRequestFullscreen;e.call(this.iframe)},e.prototype.exitFullscreen=function(){if(this.isFullscreen(this.iframe)){var e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;e.call(document)}},e.prototype.isFullscreen=function(e){var t=["fullscreenElement","webkitFullscreenElement","mozFullscreenScreenElement","msFullscreenElement"];return t.some(function(t){return document[t]===e})},e.embedUrlAttribute="powerbi-embed-url",e.accessTokenAttribute="powerbi-access-token",e.typeAttribute="powerbi-type",e.defaultOptions={filterPaneEnabled:!0},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t){"use strict";var n=function(){function e(){}return e.raiseCustomEvent=function(e,t,n){var o;if("function"==typeof CustomEvent?o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(o=document.createEvent("CustomEvent"),o.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(o),!o.defaultPrevented&&o.returnValue){var r="on"+t.replace("-",""),i=e.getAttribute(r);i&&eval.call(e,i)}},e.findIndex=function(e,t){if(!Array.isArray(t))throw new Error("You attempted to call find with second parameter that was not an array. You passed: "+t);var n;return t.some(function(t,o){return e(t)?(n=o,!0):void 0}),n},e.find=function(t,n){var o=e.findIndex(t,n);return n[o]},e.remove=function(t,n){var o=e.findIndex(t,n);n.splice(o,1)},e.assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e[0];if(void 0===n||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}return o},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return this.options.filterPaneEnabled||(t+="&filterPaneEnabled=false"),t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadReport",reportId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(2),i=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.getEmbedUrl=function(){var t=e.prototype.getEmbedUrl.call(this);return t},t.prototype.load=function(t,n){if(void 0===n&&(n=!1),n&&"string"!=typeof t.id)throw new Error("id must be specified when loading reports on existing elements.");var o={action:"loadTile",tileId:t.id,accessToken:null};e.prototype.load.call(this,t,n,o)},t}(r["default"]);Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvd2VyYmkuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiY29yZV8xIiwid2luZG93IiwiUG93ZXJiaSIsInBvd2VyYmkiLCJlbWJlZF8xIiwicmVwb3J0XzEiLCJ0aWxlXzEiLCJ1dGlsXzEiLCJQb3dlckJpIiwiY29uZmlnIiwidGhpcyIsImVtYmVkcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblJlY2VpdmVNZXNzYWdlIiwiYmluZCIsImFzc2lnbiIsImRlZmF1bHRDb25maWciLCJhdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWQiLCJlbmFibGVBdXRvRW1iZWQiLCJwcm90b3R5cGUiLCJpbml0IiwiY29udGFpbmVyIiwiX3RoaXMiLCJIVE1MRWxlbWVudCIsImRvY3VtZW50IiwiYm9keSIsImVsZW1lbnRzIiwiQXJyYXkiLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbWJlZFVybEF0dHJpYnV0ZSIsImZvckVhY2giLCJlbGVtZW50IiwiZW1iZWQiLCJjb21wb25lbnQiLCJwb3dlckJpRWxlbWVudCIsInBvd2VyQmlFbWJlZCIsImVtYmVkRXhpc3RpbmciLCJlbWJlZE5ldyIsImNvbXBvbmVudFR5cGUiLCJ0eXBlIiwiZ2V0QXR0cmlidXRlIiwidHlwZUF0dHJpYnV0ZSIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsIm91dGVySFRNTCIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsIkNvbXBvbmVudCIsImZpbmQiLCJjb21wb25lbnRzIiwiZ2V0R2xvYmFsQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInB1c2giLCJ4IiwibG9hZCIsImV2ZW50IiwiZ2V0IiwicmVzZXQiLCJyZW1vdmUiLCJpZnJhbWUiLCJxdWVyeVNlbGVjdG9yIiwic291cmNlIiwiY29udGVudFdpbmRvdyIsIm1lc3NhZ2VEYXRhIiwiZGF0YSIsInBhcnNlIiwicmFpc2VDdXN0b21FdmVudCIsImV2ZW50TWFwIiwiZSIsIm9uRXJyb3IiLCJ0aWxlQ2xpY2tlZCIsInRpbGVMb2FkZWQiLCJyZXBvcnRQYWdlTG9hZGVkIiwiYXJncyIsIl9pIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJFbWJlZCIsIm9wdGlvbnMiLCJkZWZhdWx0T3B0aW9ucyIsImdldEFjY2Vzc1Rva2VuIiwiZW1iZWRVcmwiLCJnZXRFbWJlZFVybCIsImlmcmFtZUh0bWwiLCJpbm5lckhUTUwiLCJjaGlsZE5vZGVzIiwicmVxdWlyZUlkIiwibWVzc2FnZSIsImJhc2VNZXNzYWdlIiwiYWN0aW9uIiwicG9zdE1lc3NhZ2UiLCJhY2Nlc3NUb2tlbkF0dHJpYnV0ZSIsImZ1bGxzY3JlZW4iLCJyZXF1ZXN0RnVsbFNjcmVlbiIsInJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsIm1velJlcXVlc3RGdWxsU2NyZWVuIiwid2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4iLCJleGl0RnVsbHNjcmVlbiIsImlzRnVsbHNjcmVlbiIsIm1vekNhbmNlbEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJzb21lIiwib3B0aW9uIiwiZmlsdGVyUGFuZUVuYWJsZWQiLCJVdGlscyIsImV2ZW50TmFtZSIsImV2ZW50RGF0YSIsImN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJyZXR1cm5WYWx1ZSIsImlubGluZUV2ZW50QXR0ciIsInJlcGxhY2UiLCJpbmxpbmVTY3JpcHQiLCJldmFsIiwiZmluZEluZGV4IiwicHJlZGljYXRlIiwieHMiLCJpc0FycmF5IiwiaW5kZXgiLCJpIiwic3BsaWNlIiwidGFyZ2V0IiwidW5kZWZpbmVkIiwiVHlwZUVycm9yIiwib3V0cHV0IiwibmV4dEtleSIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiZCIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiUmVwb3J0IiwiX3N1cGVyIiwiYXBwbHkiLCJyZXBvcnRJZCIsIlRpbGUiLCJ0aWxlSWQiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdBS1QsUUFBU0MsR0FBb0JDLEdBRzVCLEdBQUdDLEVBQWlCRCxHQUNuQixNQUFPQyxHQUFpQkQsR0FBVUUsT0FHbkMsSUFBSUMsR0FBU0YsRUFBaUJELElBQzdCRSxXQUNBRSxHQUFJSixFQUNKSyxRQUFRLEVBVVQsT0FOQVAsR0FBUUUsR0FBVU0sS0FBS0gsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0gsR0FHL0RJLEVBQU9FLFFBQVMsRUFHVEYsRUFBT0QsUUF2QmYsR0FBSUQsS0FxQ0osT0FUQUYsR0FBb0JRLEVBQUlULEVBR3hCQyxFQUFvQlMsRUFBSVAsRUFHeEJGLEVBQW9CVSxFQUFJLEdBR2pCVixFQUFvQixLQUsvQixTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUlXLEdBQVNYLEVBQW9CLEVBTWpDWSxRQUFPQyxRQUFVRixFQUFBQSxXQUNqQkMsT0FBT0UsUUFBVSxHQUFJSCxHQUFBQSxZQUtoQixTQUFTUCxFQUFRRCxFQUFTSCxHQUUvQixZQUNBLElBQUllLEdBQVVmLEVBQW9CLEdBQzlCZ0IsRUFBV2hCLEVBQW9CLEdBQy9CaUIsRUFBU2pCLEVBQW9CLEdBQzdCa0IsRUFBU2xCLEVBQW9CLEdBQzdCbUIsRUFBVyxXQUNYLFFBQVNBLEdBQVFDLEdBQ0UsU0FBWEEsSUFBcUJBLE1BQ3pCQyxLQUFLQyxVQUNMVixPQUFPVyxpQkFBaUIsVUFBV0YsS0FBS0csaUJBQWlCQyxLQUFLSixPQUFPLEdBRXJFQSxLQUFLRCxPQUFTRixFQUFBQSxXQUFlUSxV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UUQsRUFBU0gsR0FFL0IsWUFDQSxJQUFJMEosR0FBYXJJLE1BQVFBLEtBQUtxSSxXQUFjLFNBQVVDLEVBQUdDLEdBRXJELFFBQVNDLEtBQU94SSxLQUFLeUksWUFBY0gsRUFEbkMsSUFBSyxHQUFJakosS0FBS2tKLEdBQU9BLEVBQUVILGVBQWUvSSxLQUFJaUosRUFBRWpKLEdBQUtrSixFQUFFbEosR0FFbkRpSixHQUFFN0gsVUFBa0IsT0FBTjhILEVBQWFoRSxPQUFPbUUsT0FBT0gsSUFBTUMsRUFBRy9ILFVBQVk4SCxFQUFFOUgsVUFBVyxHQUFJK0gsS0FFL0U5SSxFQUFVZixFQUFvQixHQUM5Qm9LLEVBQVEsU0FBVUgsR0FFbEIsUUFBU0csS0FDTEgsRUFBT0MsTUFBTTdJLEtBQU1tRSxXQWtCdkIsTUFwQkFrRSxHQUFVVSxFQUFNSCxHQUloQkcsRUFBS3RJLFVBQVVzRSxZQUFjLFdBQ3pCLEdBQUlELEdBQVc4RCxFQUFPbkksVUFBVXNFLFlBQVk3RixLQUFLYyxLQUNqRCxPQUFPOEUsSUFFWGlFLEVBQUt0SSxVQUFVcUMsS0FBTyxTQUFVNkIsRUFBU1EsR0FFckMsR0FEa0IsU0FBZEEsSUFBd0JBLEdBQVksR0FDcENBLEdBQW1DLGdCQUFmUixHQUFRM0YsR0FDNUIsS0FBTSxJQUFJaUQsT0FBTSxrRUFFcEIsSUFBSW1ELElBQ0FFLE9BQVEsV0FDUjBELE9BQVFyRSxFQUFRM0YsR0FDaEIyRCxZQUFhLEtBRWpCaUcsR0FBT25JLFVBQVVxQyxLQUFLNUQsS0FBS2MsS0FBTTJFLEVBQVNRLEVBQVdDLElBRWxEMkQsR0FDVHJKLEVBQUFBLFdBQ0Y2RSxRQUFPQyxlQUFlMUYsRUFBUyxjQUFnQjJGLE9BQU8sSUFDdEQzRixFQUFBQSxXQUFrQmlLIiwiZmlsZSI6InBvd2VyYmkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xyXG5cdC8qKlxyXG5cdCAqIE1ha2UgUG93ZXJCaSBhdmFpbGFibGUgb24gZ2xvYmFsIG9iamVjdCBmb3IgdXNlIGluIGFwcHMgd2l0aG91dCBtb2R1bGUgbG9hZGluZyBzdXBwb3J0LlxyXG5cdCAqIFNhdmUgY2xhc3MgdG8gYWxsb3cgY3JlYXRpbmcgYW4gaW5zdGFuY2Ugb2YgdGhlIHNlcnZpY2UuXHJcblx0ICogQ3JlYXRlIGluc3RhbmNlIG9mIGNsYXNzIHdpdGggZGVmYXVsdCBjb25maWcgZm9yIG5vcm1hbCB1c2FnZS5cclxuXHQgKi9cclxuXHR3aW5kb3cuUG93ZXJiaSA9IGNvcmVfMS5kZWZhdWx0O1xyXG5cdHdpbmRvdy5wb3dlcmJpID0gbmV3IGNvcmVfMS5kZWZhdWx0KCk7XHJcblxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIGVtYmVkXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciByZXBvcnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XHJcblx0dmFyIHRpbGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XHJcblx0dmFyIHV0aWxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcblx0dmFyIFBvd2VyQmkgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBQb3dlckJpKGNvbmZpZykge1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZyA9PT0gdm9pZCAwKSB7IGNvbmZpZyA9IHt9OyB9XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcyA9IFtdO1xyXG5cdCAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uUmVjZWl2ZU1lc3NhZ2UuYmluZCh0aGlzKSwgZmFsc2UpO1xyXG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXHJcblx0ICAgICAgICB0aGlzLmNvbmZpZyA9IHV0aWxfMS5kZWZhdWx0LmFzc2lnbih7fSwgUG93ZXJCaS5kZWZhdWx0Q29uZmlnLCBjb25maWcpO1xyXG5cdCAgICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dG9FbWJlZE9uQ29udGVudExvYWRlZCkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuZW5hYmxlQXV0b0VtYmVkKCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIERPTUNvbnRlbnRMb2FkZWQgd2hpY2ggc2VhcmNoZXMgRE9NIGZvciBlbGVtZW50cyBoYXZpbmcgJ3Bvd2VyYmktZW1iZWQtdXJsJyBhdHRyaWJ1dGVcclxuXHQgICAgICogYW5kIGF1dG9tYXRpY2FsbHkgYXR0ZW1wdHMgdG8gZW1iZWQgYSBwb3dlcmJpIGNvbXBvbmVudCBiYXNlZCBvbiBpbmZvcm1hdGlvbiBmcm9tIHRoZSBhdHRyaWJ1dGVzLlxyXG5cdCAgICAgKiBPbmx5IHJ1bnMgaWYgYGNvbmZpZy5hdXRvRW1iZWRPbkNvbnRlbnRMb2FkZWRgIGlzIHRydWUgd2hlbiB0aGUgc2VydmljZSBpcyBjcmVhdGVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBjb250YWluZXIgPSAoY29udGFpbmVyICYmIGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHk7XHJcblx0ICAgICAgICB2YXIgZWxlbWVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIltcIiArIGVtYmVkXzEuZGVmYXVsdC5lbWJlZFVybEF0dHJpYnV0ZSArIFwiXVwiKSk7XHJcblx0ICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBfdGhpcy5lbWJlZChlbGVtZW50KTsgfSk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBHaXZlbiBhbiBodG1sIGVsZW1lbnQgZW1iZWQgY29tcG9uZW50IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb24uXHJcblx0ICAgICAqIElmIGNvbXBvbmVudCBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgYW5kIGF0dGFjaGVkIHRvIGVsZW1lbnQgcmUtdXNlIGNvbXBvbmVudCBpbnN0YW5jZSBhbmQgZXhpc3RpbmcgaWZyYW1lLFxyXG5cdCAgICAgKiBvdGhlcndpc2UgY3JlYXRlIGEgbmV3IGNvbXBvbmVudCBpbnN0YW5jZVxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUuZW1iZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29uZmlnKSB7XHJcblx0ICAgICAgICBpZiAoY29uZmlnID09PSB2b2lkIDApIHsgY29uZmlnID0ge307IH1cclxuXHQgICAgICAgIHZhciBjb21wb25lbnQ7XHJcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgaWYgKHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZCkge1xyXG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWRFeGlzdGluZyhwb3dlckJpRWxlbWVudCwgY29uZmlnKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIGNvbXBvbmVudCA9IHRoaXMuZW1iZWROZXcocG93ZXJCaUVsZW1lbnQsIGNvbmZpZyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gaHRtbCBlbGVtZW50IGVtYmVkIGNvbXBvbmVudCBiYXNlIGNvbmZpZ3VyYXRpb24uXHJcblx0ICAgICAqIFNhdmUgY29tcG9uZW50IGluc3RhbmNlIG9uIGVsZW1lbnQgZm9yIGxhdGVyIGxvb2t1cC5cclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVtYmVkTmV3ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIHZhciBjb21wb25lbnRUeXBlID0gY29uZmlnLnR5cGUgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoZW1iZWRfMS5kZWZhdWx0LnR5cGVBdHRyaWJ1dGUpO1xyXG5cdCAgICAgICAgaWYgKCFjb21wb25lbnRUeXBlKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGVtYmVkIHVzaW5nIGNvbmZpZyBcIiArIEpTT04uc3RyaW5naWZ5KGNvbmZpZykgKyBcIiBvbiBlbGVtZW50IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiwgYnV0IGNvdWxkIG5vdCBkZXRlcm1pbmUgd2hhdCB0eXBlIG9mIGNvbXBvbmVudCB0byBlbWJlZC4gWW91IG11c3Qgc3BlY2lmeSBhIHR5cGUgaW4gdGhlIGNvbmZpZ3VyYXRpb24gb3IgYXMgYW4gYXR0cmlidXRlIHN1Y2ggYXMgJ1wiICsgZW1iZWRfMS5kZWZhdWx0LnR5cGVBdHRyaWJ1dGUgKyBcIj1cXFwiXCIgKyByZXBvcnRfMS5kZWZhdWx0Lm5hbWUudG9Mb3dlckNhc2UoKSArIFwiXFxcIicuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gU2F2ZSB0eXBlIG9uIGNvbmZpZ3VyYXRpb24gc28gaXQgY2FuIGJlIHJlZmVyZW5jZWQgbGF0ZXIgYXQga25vd24gbG9jYXRpb25cclxuXHQgICAgICAgIGNvbmZpZy50eXBlID0gY29tcG9uZW50VHlwZTtcclxuXHQgICAgICAgIHZhciBDb21wb25lbnQgPSB1dGlsXzEuZGVmYXVsdC5maW5kKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIGNvbXBvbmVudFR5cGUgPT09IGNvbXBvbmVudC5uYW1lLnRvTG93ZXJDYXNlKCk7IH0sIFBvd2VyQmkuY29tcG9uZW50cyk7XHJcblx0ICAgICAgICBpZiAoIUNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBlbWJlZCBjb21wb25lbnQgb2YgdHlwZTogXCIgKyBjb21wb25lbnRUeXBlICsgXCIgYnV0IGRpZCBub3QgZmluZCBhbnkgbWF0Y2hpbmcgY29tcG9uZW50LiAgUGxlYXNlIHZlcmlmeSB0aGUgdHlwZSB5b3Ugc3BlY2lmaWVkIGlzIGludGVuZGVkLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIHJlbW92aW5nIGluIGZhdm9yIG9mIHBhc3NpbmcgcmVmZXJlbmNlIHRvIGB0aGlzYCBpbiBjb25zdHJ1Y3RvclxyXG5cdCAgICAgICAgLy8gVGhlIGdldEdsb2JhbEFjY2Vzc1Rva2VuIGZ1bmN0aW9uIGlzIG9ubHkgaGVyZSBzbyB0aGF0IHRoZSBjb21wb25lbnRzIChUaWxlIHwgUmVwb3J0KSBjYW4gZ2V0IHRoZSBnbG9iYWwgYWNjZXNzIHRva2VuIHdpdGhvdXQgbmVlZGluZyByZWZlcmVuY2VcclxuXHQgICAgICAgIC8vIHRvIHRoZSBzZXJ2aWNlIHRoYXQgdGhleSBhcmUgcmVnaXN0ZXJlZCB3aXRoaW4gYmVjYXVlcyBpdCBjcmVhdGVzIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xyXG5cdCAgICAgICAgY29uZmlnLmdldEdsb2JhbEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYWNjZXNzVG9rZW47IH07XHJcblx0ICAgICAgICB2YXIgY29tcG9uZW50ID0gbmV3IENvbXBvbmVudChlbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICAgICAgZWxlbWVudC5wb3dlckJpRW1iZWQgPSBjb21wb25lbnQ7XHJcblx0ICAgICAgICB0aGlzLmVtYmVkcy5wdXNoKGNvbXBvbmVudCk7XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5lbWJlZEV4aXN0aW5nID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbmZpZykge1xyXG5cdCAgICAgICAgdmFyIGNvbXBvbmVudCA9IHV0aWxfMS5kZWZhdWx0LmZpbmQoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZWxlbWVudCA9PT0gZWxlbWVudDsgfSwgdGhpcy5lbWJlZHMpO1xyXG5cdCAgICAgICAgaWYgKCFjb21wb25lbnQpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZW1iZWQgdXNpbmcgY29uZmlnIFwiICsgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSArIFwiIG9uIGVsZW1lbnQgXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiIHdoaWNoIGFscmVhZHkgaGFzIGVtYmVkZGVkIGNvbW9wbmVudCBhc3NvY2lhdGVkLCBidXQgY291bGQgbm90IGZpbmQgdGhlIGV4aXN0aW5nIGNvbW9wbmVudCBpbiB0aGUgbGlzdCBvZiBhY3RpdmUgY29tcG9uZW50cy4gVGhpcyBjb3VsZCBpbmRpY2F0ZSB0aGUgZW1iZWRzIGxpc3QgaXMgb3V0IG9mIHN5bmMgd2l0aCB0aGUgRE9NLCBvciB0aGUgY29tcG9uZW50IGlzIHJlZmVyZW5jaW5nIHRoZSBpbmNvcnJlY3QgSFRNTCBlbGVtZW50LlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGNvbXBvbmVudC5sb2FkKGNvbmZpZywgdHJ1ZSk7XHJcblx0ICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogQWRkcyBldmVudCBoYW5kbGVyIGZvciBET01Db250ZW50TG9hZGVkIHdoaWNoIGZpbmRzIGFsbCBlbGVtZW50cyBpbiBET00gd2l0aCBhdHRyaWJ1dGUgcG93ZXJiaS1lbWJlZC11cmxcclxuXHQgICAgICogdGhlbiBhdHRlbXB0cyB0byBpbml0aWF0ZSB0aGUgZW1iZWQgcHJvY2VzcyBiYXNlZCBvbiBkYXRhIGZyb20gb3RoZXIgcG93ZXJiaS0qIGF0dHJpYnV0ZXMuXHJcblx0ICAgICAqIChUaGlzIGlzIHVzdWFsbHkgb25seSB1c2VmdWwgZm9yIGFwcGxpY2F0aW9ucyByZW5kZXJlZCBvbiBieSB0aGUgc2VydmVyIHNpbmNlIGFsbCB0aGUgZGF0YSBuZWVkZWQgd2lsbCBiZSBhdmFpbGFibGUgYnkgdGhlIHRpbWUgdGhlIGhhbmRsZXIgaXMgY2FsbGVkLilcclxuXHQgICAgICovXHJcblx0ICAgIFBvd2VyQmkucHJvdG90eXBlLmVuYWJsZUF1dG9FbWJlZCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaW5pdChkb2N1bWVudC5ib2R5KTsgfSwgZmFsc2UpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmV0dXJucyBpbnN0YW5jZSBvZiBjb21wb25lbnQgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdCAgICAgICAgdmFyIHBvd2VyQmlFbGVtZW50ID0gZWxlbWVudDtcclxuXHQgICAgICAgIGlmICghcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBnZXQgYW4gaW5zdGFuY2Ugb2YgcG93ZXJiaSBjb21wb25lbnQgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQ6IFwiICsgZWxlbWVudC5vdXRlckhUTUwgKyBcIiBidXQgdGhlcmUgd2FzIG5vIGFzc29jaWF0ZWQgaW5zdGFuY2UuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIHBvd2VyQmlFbGVtZW50LnBvd2VyQmlFbWJlZDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdpdmVuIGFuIGh0bWwgZWxlbWVudCB3aGljaCBoYXMgY29tcG9uZW50IGVtYmVkZGVkIHdpdGhpbiBpdCwgcmVtb3ZlIHRoZSBjb21wb25lbnQgZnJvbSBsaXN0IG9mIGVtYmVkcywgcmVtb3ZlIGFzc29jaWF0aW9uIHdpdGggY29tcG9uZW50LCBhbmQgcmVtb3ZlIHRoZSBpZnJhbWUuXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcblx0ICAgICAgICB2YXIgcG93ZXJCaUVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgaWYgKCFwb3dlckJpRWxlbWVudC5wb3dlckJpRW1iZWQpIHtcclxuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXR0ZW1wdGVkIHRvIGdldCBhbiBpbnN0YW5jZSBvZiBwb3dlcmJpIGNvbXBvbmVudCBhc3NvY2lhdGVkIHdpdGggZWxlbWVudDogXCIgKyBlbGVtZW50Lm91dGVySFRNTCArIFwiIGJ1dCB0aGVyZSB3YXMgbm8gYXNzb2NpYXRlZCBpbnN0YW5jZS5cIik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvKiogUmVtb3ZlIGNvbXBvbmVudCBmcm9tIGludGVybmFsIGxpc3QgKi9cclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJlbW92ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA9PT0gcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkOyB9LCB0aGlzLmVtYmVkcyk7XHJcblx0ICAgICAgICAvKiogRGVsZXRlIHByb3BlcnR5IGZyb20gaHRtbCBlbGVtZW50ICovXHJcblx0ICAgICAgICBkZWxldGUgcG93ZXJCaUVsZW1lbnQucG93ZXJCaUVtYmVkO1xyXG5cdCAgICAgICAgLyoqIFJlbW92ZSBpZnJhbWUgZnJvbSBlbGVtZW50IGJ5IGNsZWFyaW5nIGlubmVySFRNTCAqL1xyXG5cdCAgICAgICAgdmFyIGlmcmFtZSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7XHJcblx0ICAgICAgICBpZiAoaWZyYW1lKSB7XHJcblx0ICAgICAgICAgICAgaWZyYW1lLnJlbW92ZSgpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciBmb3Igd2luZG93IG1lc3NhZ2UgZXZlbnQuXHJcblx0ICAgICAqIFBhcnNlcyBldmVudCBkYXRhIGFzIGpzb24gYW5kIGlmIGl0IGNhbWUgZnJvbSBhbiBpZnJhbWUgdGhhdCBtYXRjaGVzIG9uZSBmcm9tIGFuIGV4aXN0aW5nIGVtYmVkZWQgY29tcG9uZW50IHJlLWRpc3BhdGNoZXMgdGhlIGV2ZW50IG9uIHRoZSBpZnJhbWUncyBwYXJlbnQgZWxlbWVudFxyXG5cdCAgICAgKiB0byBzaW11bGF0ZSB0aGUgZXZlbnQgYnViYmxpbmcgdGhyb3VnaCB0aGUgdHdvIHNlcGFyYXRlIHdpbmRvd3MgLyBET01zLlxyXG5cdCAgICAgKlxyXG5cdCAgICAgKiBJZiBhbiBlcnJvciBvY2N1cnMgd2hlbiBwYXJzaW5nIGV2ZW50LmRhdGEgY2FsbCBlcnJvciBoYW5kbGVyIHByb3ZpZGVkIGR1cmluZyBjb25maWd1cmF0aW9uLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5wcm90b3R5cGUub25SZWNlaXZlTWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkge1xyXG5cdCAgICAgICAgaWYgKCFldmVudCkge1xyXG5cdCAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHRyeSB7XHJcblx0ICAgICAgICAgICAgLy8gT25seSByYWlzZSB0aGUgZXZlbnQgb24gdGhlIGVtYmVkIHRoYXQgbWF0Y2hlcyB0aGUgcG9zdCBtZXNzYWdlIG9yaWdpblxyXG5cdCAgICAgICAgICAgIHZhciBlbWJlZCA9IHV0aWxfMS5kZWZhdWx0LmZpbmQoZnVuY3Rpb24gKGVtYmVkKSB7IHJldHVybiBldmVudC5zb3VyY2UgPT09IGVtYmVkLmlmcmFtZS5jb250ZW50V2luZG93OyB9LCB0aGlzLmVtYmVkcyk7XHJcblx0ICAgICAgICAgICAgaWYgKGVtYmVkKSB7XHJcblx0ICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlRGF0YSA9IHR5cGVvZiBldmVudC5kYXRhID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkgOiBldmVudC5kYXRhO1xyXG5cdCAgICAgICAgICAgICAgICB1dGlsXzEuZGVmYXVsdC5yYWlzZUN1c3RvbUV2ZW50KGVtYmVkLmVsZW1lbnQsIFBvd2VyQmkuZXZlbnRNYXBbbWVzc2FnZURhdGEuZXZlbnRdLCBtZXNzYWdlRGF0YSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgY2F0Y2ggKGUpIHtcclxuXHQgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY29uZmlnLm9uRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcclxuXHQgICAgICAgICAgICAgICAgdGhpcy5jb25maWcub25FcnJvci5jYWxsKHdpbmRvdywgZSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIExpc3Qgb2YgY29tcG9uZW50cyB0aGlzIHNlcnZpY2UgY2FuIGVtYmVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5jb21wb25lbnRzID0gW1xyXG5cdCAgICAgICAgdGlsZV8xLmRlZmF1bHQsXHJcblx0ICAgICAgICByZXBvcnRfMS5kZWZhdWx0XHJcblx0ICAgIF07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBNYXBwaW5nIG9mIGV2ZW50IG5hbWVzIGZyb20gaWZyYW1lIHBvc3RNZXNzYWdlIHRvIHRoZWlyIG5hbWUgcGVyY2lldmVkIGJ5IHBhcmVudCBET00uXHJcblx0ICAgICAqIEV4YW1wbGU6IFVzZXIgY2xpY2tzIG9uIGVtYmVkZWQgcmVwb3J0IHdoaWNoIGlzIGluc2lkZSBpZnJhbWUuIFRoZSBpZnJhbWUgY29kZSByZXNlbmRzXHJcblx0ICAgICAqIGV2ZW50IGFzIHBvc3RNZXNzYWdlIHdpdGggeyBldmVudDogJ3JlcG9ydENsaWNrZWQnLCAuLi4gfSBhbmQgdGhpcyBuYW1lIGlzIGNvbnZlcnRlZCB0byBoeXBoZW5hdGVkXHJcblx0ICAgICAqIG5hbWUgYW5kIGRpc3BhdGNoZWQgZnJvbSB0aGUgcGFyZW50IGVsZW1lbnQgb2YgdGhlIGlmcmFtZSB0byBzaW11bGF0ZSB0aGUgZXZlbnQgYnViYmxpbmcgdGhyb3VnaCB0d29cclxuXHQgICAgICogZGlmZmVyZW50IHdpbmRvd3MgLyBET01zXHJcblx0ICAgICAqL1xyXG5cdCAgICBQb3dlckJpLmV2ZW50TWFwID0ge1xyXG5cdCAgICAgICAgJ3RpbGVDbGlja2VkJzogJ3RpbGUtY2xpY2snLFxyXG5cdCAgICAgICAgJ3RpbGVMb2FkZWQnOiAndGlsZS1sb2FkJyxcclxuXHQgICAgICAgICdyZXBvcnRQYWdlTG9hZGVkJzogJ3JlcG9ydC1sb2FkJ1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRGVmYXVsdCBjb25maWd1cmF0aW9uIGZvciBzZXJ2aWNlLlxyXG5cdCAgICAgKi9cclxuXHQgICAgUG93ZXJCaS5kZWZhdWx0Q29uZmlnID0ge1xyXG5cdCAgICAgICAgYXV0b0VtYmVkT25Db250ZW50TG9hZGVkOiBmYWxzZSxcclxuXHQgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG5cdCAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcblx0ICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhhcmdzWzBdLCBhcmdzLnNsaWNlKDEpKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIFBvd2VyQmk7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLlBvd2VyQmkgPSBQb3dlckJpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBQb3dlckJpO1xyXG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciB1dGlsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xyXG5cdHZhciBFbWJlZCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIEVtYmVkKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdCAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gT2JqZWN0LmFzc2lnbiBpcyBhdmFpbGFibGUuXHJcblx0ICAgICAgICB0aGlzLm9wdGlvbnMgPSB1dGlsXzEuZGVmYXVsdC5hc3NpZ24oe30sIEVtYmVkLmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuXHQgICAgICAgIHRoaXMub3B0aW9ucy5lbWJlZFVybCA9IHRoaXMuZ2V0RW1iZWRVcmwoKTtcclxuXHQgICAgICAgIHZhciBpZnJhbWVIdG1sID0gXCI8aWZyYW1lIHN0eWxlPVxcXCJ3aWR0aDoxMDAlO2hlaWdodDoxMDAlO1xcXCIgc3JjPVxcXCJcIiArIHRoaXMub3B0aW9ucy5lbWJlZFVybCArIFwiXFxcIiBzY3JvbGxpbmc9XFxcIm5vXFxcIiBhbGxvd2Z1bGxzY3JlZW49XFxcInRydWVcXFwiPjwvaWZyYW1lPlwiO1xyXG5cdCAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGlmcmFtZUh0bWw7XHJcblx0ICAgICAgICB0aGlzLmlmcmFtZSA9IHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzWzBdO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmxvYWQoX3RoaXMub3B0aW9ucywgZmFsc2UpOyB9LCBmYWxzZSk7XHJcblx0ICAgIH1cclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEhhbmRsZXIgZm9yIHdoZW4gdGhlIGlmcmFtZSBoYXMgZmluaXNoZWQgbG9hZGluZyB0aGUgcG93ZXJiaSBwbGFjZWhvbGRlciBwYWdlLlxyXG5cdCAgICAgKiBUaGlzIGlzIHVzZWQgdG8gaW5qZWN0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBzdWNoIGFzIGFjY2VzcyB0b2tlbiwgbG9hZEFjdGlvbiwgZXRjXHJcblx0ICAgICAqIHdoaWNoIGFsbG93IGlmcmFtZSB0byBsb2FkIHRoZSBhY3R1YWwgcmVwb3J0IHdpdGggYXV0aGVudGljYXRpb24uXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChvcHRpb25zLCByZXF1aXJlSWQsIG1lc3NhZ2UpIHtcclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgPT09IHZvaWQgMCkgeyByZXF1aXJlSWQgPSBmYWxzZTsgfVxyXG5cdCAgICAgICAgaWYgKG1lc3NhZ2UgPT09IHZvaWQgMCkgeyBtZXNzYWdlID0gbnVsbDsgfVxyXG5cdCAgICAgICAgaWYgKCFtZXNzYWdlKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGNhbGxlZCBsb2FkIHdpdGhvdXQgcHJvdmlkaW5nIG1lc3NhZ2UgcHJvcGVydGllcyBmcm9tIHRoZSBjb25jcmV0ZSBlbWJlZGRhYmxlIGNsYXNzLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBiYXNlTWVzc2FnZSA9IHtcclxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogb3B0aW9ucy5hY2Nlc3NUb2tlblxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LmFzc2lnbihtZXNzYWdlLCBiYXNlTWVzc2FnZSk7XHJcblx0ICAgICAgICB2YXIgZXZlbnQgPSB7XHJcblx0ICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIHV0aWxfMS5kZWZhdWx0LnJhaXNlQ3VzdG9tRXZlbnQodGhpcy5lbGVtZW50LCBldmVudC5tZXNzYWdlLmFjdGlvbiwgZXZlbnQpO1xyXG5cdCAgICAgICAgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeShldmVudC5tZXNzYWdlKSwgJyonKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdldCBhY2Nlc3MgdG9rZW4gZnJvbSBmaXJzdCBhdmFpbGFibGUgbG9jYXRpb246IG9wdGlvbnMsIGF0dHJpYnV0ZSwgZ2xvYmFsLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmdldEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIGFjY2Vzc1Rva2VuID0gdGhpcy5vcHRpb25zLmFjY2Vzc1Rva2VuIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoRW1iZWQuYWNjZXNzVG9rZW5BdHRyaWJ1dGUpIHx8IHRoaXMub3B0aW9ucy5nZXRHbG9iYWxBY2Nlc3NUb2tlbigpO1xyXG5cdCAgICAgICAgaWYgKCFhY2Nlc3NUb2tlbikge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFjY2VzcyB0b2tlbiB3YXMgZm91bmQgZm9yIGVsZW1lbnQuIFlvdSBtdXN0IHNwZWNpZnkgYW4gYWNjZXNzIHRva2VuIGRpcmVjdGx5IG9uIHRoZSBlbGVtZW50IHVzaW5nIGF0dHJpYnV0ZSAnXCIgKyBFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSArIFwiJyBvciBzcGVjaWZ5IGEgZ2xvYmFsIHRva2VuIGF0OiBwb3dlcmJpLmFjY2Vzc1Rva2VuLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdldCBlbWJlZCB1cmwgZnJvbSBmaXJzdCBhdmFpbGFibGUgbG9jYXRpb246IG9wdGlvbnMsIGF0dHJpYnV0ZS5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IHRoaXMub3B0aW9ucy5lbWJlZFVybCB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKEVtYmVkLmVtYmVkVXJsQXR0cmlidXRlKTtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgZW1iZWRVcmwgIT09ICdzdHJpbmcnIHx8IGVtYmVkVXJsLmxlbmd0aCA9PT0gMCkge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtYmVkIFVybCBpcyByZXF1aXJlZCwgYnV0IGl0IHdhcyBub3QgZm91bmQuIFlvdSBtdXN0IHByb3ZpZGUgYW4gZW1iZWQgdXJsIGVpdGhlciBhcyBwYXJ0IG9mIGVtYmVkIGNvbmZpZ3VyYXRpb24gb3IgYXMgYXR0cmlidXRlICdcIiArIEVtYmVkLmVtYmVkVXJsQXR0cmlidXRlICsgXCInLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJlcXVlc3QgdGhlIGJyb3dzZXIgdG8gbWFrZSB0aGUgY29tcG9uZW50cyBpZnJhbWUgZnVsbHNjcmVlbi5cclxuXHQgICAgICovXHJcblx0ICAgIEVtYmVkLnByb3RvdHlwZS5mdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdmFyIHJlcXVlc3RGdWxsU2NyZWVuID0gdGhpcy5pZnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4gfHwgdGhpcy5pZnJhbWUubXNSZXF1ZXN0RnVsbHNjcmVlbiB8fCB0aGlzLmlmcmFtZS5tb3pSZXF1ZXN0RnVsbFNjcmVlbiB8fCB0aGlzLmlmcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbjtcclxuXHQgICAgICAgIHJlcXVlc3RGdWxsU2NyZWVuLmNhbGwodGhpcy5pZnJhbWUpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogRXhpdCBmdWxsc2NyZWVuLlxyXG5cdCAgICAgKi9cclxuXHQgICAgRW1iZWQucHJvdG90eXBlLmV4aXRGdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgaWYgKCF0aGlzLmlzRnVsbHNjcmVlbih0aGlzLmlmcmFtZSkpIHtcclxuXHQgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgZXhpdEZ1bGxzY3JlZW4gPSBkb2N1bWVudC5leGl0RnVsbHNjcmVlbiB8fCBkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuIHx8IGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuIHx8IGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW47XHJcblx0ICAgICAgICBleGl0RnVsbHNjcmVlbi5jYWxsKGRvY3VtZW50KTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJldHVybiB0cnVlIGlmIGlmcmFtZSBpcyBmdWxsc2NyZWVuLFxyXG5cdCAgICAgKiBvdGhlcndpc2UgcmV0dXJuIGZhbHNlXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5wcm90b3R5cGUuaXNGdWxsc2NyZWVuID0gZnVuY3Rpb24gKGlmcmFtZSkge1xyXG5cdCAgICAgICAgdmFyIG9wdGlvbnMgPSBbJ2Z1bGxzY3JlZW5FbGVtZW50JywgJ3dlYmtpdEZ1bGxzY3JlZW5FbGVtZW50JywgJ21vekZ1bGxzY3JlZW5TY3JlZW5FbGVtZW50JywgJ21zRnVsbHNjcmVlbkVsZW1lbnQnXTtcclxuXHQgICAgICAgIHJldHVybiBvcHRpb25zLnNvbWUoZnVuY3Rpb24gKG9wdGlvbikgeyByZXR1cm4gZG9jdW1lbnRbb3B0aW9uXSA9PT0gaWZyYW1lOyB9KTtcclxuXHQgICAgfTtcclxuXHQgICAgRW1iZWQuZW1iZWRVcmxBdHRyaWJ1dGUgPSAncG93ZXJiaS1lbWJlZC11cmwnO1xyXG5cdCAgICBFbWJlZC5hY2Nlc3NUb2tlbkF0dHJpYnV0ZSA9ICdwb3dlcmJpLWFjY2Vzcy10b2tlbic7XHJcblx0ICAgIEVtYmVkLnR5cGVBdHRyaWJ1dGUgPSAncG93ZXJiaS10eXBlJztcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIERlZmF1bHQgb3B0aW9ucyBmb3IgZW1iZWRkYWJsZSBjb21wb25lbnQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBFbWJlZC5kZWZhdWx0T3B0aW9ucyA9IHtcclxuXHQgICAgICAgIGZpbHRlclBhbmVFbmFibGVkOiB0cnVlXHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBFbWJlZDtcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBFbWJlZDtcclxuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgVXRpbHMgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBVdGlscygpIHtcclxuXHQgICAgfVxyXG5cdCAgICBVdGlscy5yYWlzZUN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgZXZlbnREYXRhKSB7XHJcblx0ICAgICAgICB2YXIgY3VzdG9tRXZlbnQ7XHJcblx0ICAgICAgICBpZiAodHlwZW9mIEN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XHJcblx0ICAgICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnROYW1lLCB7XHJcblx0ICAgICAgICAgICAgICAgIGRldGFpbDogZXZlbnREYXRhLFxyXG5cdCAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxyXG5cdCAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlXHJcblx0ICAgICAgICAgICAgfSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICBjdXN0b21FdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xyXG5cdCAgICAgICAgICAgIGN1c3RvbUV2ZW50LmluaXRDdXN0b21FdmVudChldmVudE5hbWUsIHRydWUsIHRydWUsIGV2ZW50RGF0YSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xyXG5cdCAgICAgICAgaWYgKGN1c3RvbUV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgfHwgIWN1c3RvbUV2ZW50LnJldHVyblZhbHVlKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gVE9ETzogUmVtb3ZlIHRoaXM/IFNob3VsZCBiZSBiZXR0ZXIgd2F5IHRvIGhhbmRsZSBldmVudHMgdGhhbiB1c2luZyBldmFsP1xyXG5cdCAgICAgICAgLy8gV2hhdCBpcyB1c2UgY2FzZT8gPGRpdiBwb3dlcmJpLXR5cGU9XCJyZXBvcnRcIiBvbmxvYWQ9XCJhbGVydCgnbG9hZGVkJyk7XCI+PC9kaXY+XHJcblx0ICAgICAgICB2YXIgaW5saW5lRXZlbnRBdHRyID0gJ29uJyArIGV2ZW50TmFtZS5yZXBsYWNlKCctJywgJycpO1xyXG5cdCAgICAgICAgdmFyIGlubGluZVNjcmlwdCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGlubGluZUV2ZW50QXR0cik7XHJcblx0ICAgICAgICBpZiAoaW5saW5lU2NyaXB0KSB7XHJcblx0ICAgICAgICAgICAgZXZhbC5jYWxsKGVsZW1lbnQsIGlubGluZVNjcmlwdCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLmZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XHJcblx0ICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoeHMpKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGF0dGVtcHRlZCB0byBjYWxsIGZpbmQgd2l0aCBzZWNvbmQgcGFyYW1ldGVyIHRoYXQgd2FzIG5vdCBhbiBhcnJheS4gWW91IHBhc3NlZDogXCIgKyB4cyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgaW5kZXg7XHJcblx0ICAgICAgICB4cy5zb21lKGZ1bmN0aW9uICh4LCBpKSB7XHJcblx0ICAgICAgICAgICAgaWYgKHByZWRpY2F0ZSh4KSkge1xyXG5cdCAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcblx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgcmV0dXJuIGluZGV4O1xyXG5cdCAgICB9O1xyXG5cdCAgICBVdGlscy5maW5kID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgeHMpIHtcclxuXHQgICAgICAgIHZhciBpbmRleCA9IFV0aWxzLmZpbmRJbmRleChwcmVkaWNhdGUsIHhzKTtcclxuXHQgICAgICAgIHJldHVybiB4c1tpbmRleF07XHJcblx0ICAgIH07XHJcblx0ICAgIFV0aWxzLnJlbW92ZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHhzKSB7XHJcblx0ICAgICAgICB2YXIgaW5kZXggPSBVdGlscy5maW5kSW5kZXgocHJlZGljYXRlLCB4cyk7XHJcblx0ICAgICAgICB4cy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvLyBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9hc3NpZ25cclxuXHQgICAgLy8gVE9ETzogcmVwbGFjZSBpbiBmYXZvciBvZiB1c2luZyBwb2x5ZmlsbFxyXG5cdCAgICBVdGlscy5hc3NpZ24gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG5cdCAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuXHQgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIHRhcmdldCA9IGFyZ3NbMF07XHJcblx0ICAgICAgICAndXNlIHN0cmljdCc7XHJcblx0ICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdGFyZ2V0ID09PSBudWxsKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB2YXIgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XHJcblx0ICAgICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgYXJndW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cdCAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xyXG5cdCAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcclxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBzb3VyY2UpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSBzb3VyY2VbbmV4dEtleV07XHJcblx0ICAgICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gVXRpbHM7XHJcblx0fSgpKTtcclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcblx0ZXhwb3J0cy5kZWZhdWx0ID0gVXRpbHM7XHJcblxuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuXHR9O1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgUmVwb3J0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuXHQgICAgX19leHRlbmRzKFJlcG9ydCwgX3N1cGVyKTtcclxuXHQgICAgZnVuY3Rpb24gUmVwb3J0KCkge1xyXG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0ICAgIH1cclxuXHQgICAgUmVwb3J0LnByb3RvdHlwZS5nZXRFbWJlZFVybCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgIHZhciBlbWJlZFVybCA9IF9zdXBlci5wcm90b3R5cGUuZ2V0RW1iZWRVcmwuY2FsbCh0aGlzKTtcclxuXHQgICAgICAgIC8vIFRPRE86IE5lZWQgc2FmZSB3YXkgdG8gYWRkIHVybCBwYXJhbWV0ZXJzLlxyXG5cdCAgICAgICAgLy8gV2UgYXJlIGFzc3VtaW5nIGVtYmVkVXJscyB1c2UgcXVlcnkgcGFyYW1ldGVycyB0byBzdXBwbHkgaWQgb2YgdmlzdWFsXHJcblx0ICAgICAgICAvLyBzbyBtdXN0IHByZWZpeCB3aXRoICcmJy5cclxuXHQgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmZpbHRlclBhbmVFbmFibGVkKSB7XHJcblx0ICAgICAgICAgICAgZW1iZWRVcmwgKz0gXCImZmlsdGVyUGFuZUVuYWJsZWQ9ZmFsc2VcIjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBlbWJlZFVybDtcclxuXHQgICAgfTtcclxuXHQgICAgUmVwb3J0LnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKG9wdGlvbnMsIHJlcXVpcmVJZCkge1xyXG5cdCAgICAgICAgaWYgKHJlcXVpcmVJZCA9PT0gdm9pZCAwKSB7IHJlcXVpcmVJZCA9IGZhbHNlOyB9XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkICYmIHR5cGVvZiBvcHRpb25zLmlkICE9PSAnc3RyaW5nJykge1xyXG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlkIG11c3QgYmUgc3BlY2lmaWVkIHdoZW4gbG9hZGluZyByZXBvcnRzIG9uIGV4aXN0aW5nIGVsZW1lbnRzLlwiKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciBtZXNzYWdlID0ge1xyXG5cdCAgICAgICAgICAgIGFjdGlvbjogJ2xvYWRSZXBvcnQnLFxyXG5cdCAgICAgICAgICAgIHJlcG9ydElkOiBvcHRpb25zLmlkLFxyXG5cdCAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBudWxsXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkLmNhbGwodGhpcywgb3B0aW9ucywgcmVxdWlyZUlkLCBtZXNzYWdlKTtcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIFJlcG9ydDtcclxuXHR9KGVtYmVkXzEuZGVmYXVsdCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBSZXBvcnQ7XHJcblxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG5cdCAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcblx0ICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuXHR9O1xyXG5cdHZhciBlbWJlZF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgVGlsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcblx0ICAgIF9fZXh0ZW5kcyhUaWxlLCBfc3VwZXIpO1xyXG5cdCAgICBmdW5jdGlvbiBUaWxlKCkge1xyXG5cdCAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0ICAgIH1cclxuXHQgICAgVGlsZS5wcm90b3R5cGUuZ2V0RW1iZWRVcmwgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICB2YXIgZW1iZWRVcmwgPSBfc3VwZXIucHJvdG90eXBlLmdldEVtYmVkVXJsLmNhbGwodGhpcyk7XHJcblx0ICAgICAgICByZXR1cm4gZW1iZWRVcmw7XHJcblx0ICAgIH07XHJcblx0ICAgIFRpbGUucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAob3B0aW9ucywgcmVxdWlyZUlkKSB7XHJcblx0ICAgICAgICBpZiAocmVxdWlyZUlkID09PSB2b2lkIDApIHsgcmVxdWlyZUlkID0gZmFsc2U7IH1cclxuXHQgICAgICAgIGlmIChyZXF1aXJlSWQgJiYgdHlwZW9mIG9wdGlvbnMuaWQgIT09ICdzdHJpbmcnKSB7XHJcblx0ICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBsb2FkaW5nIHJlcG9ydHMgb24gZXhpc3RpbmcgZWxlbWVudHMuXCIpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XHJcblx0ICAgICAgICAgICAgYWN0aW9uOiAnbG9hZFRpbGUnLFxyXG5cdCAgICAgICAgICAgIHRpbGVJZDogb3B0aW9ucy5pZCxcclxuXHQgICAgICAgICAgICBhY2Nlc3NUb2tlbjogbnVsbFxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIF9zdXBlci5wcm90b3R5cGUubG9hZC5jYWxsKHRoaXMsIG9wdGlvbnMsIHJlcXVpcmVJZCwgbWVzc2FnZSk7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBUaWxlO1xyXG5cdH0oZW1iZWRfMS5kZWZhdWx0KSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IFRpbGU7XHJcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBvd2VyYmkuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
